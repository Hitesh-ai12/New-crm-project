import{_ as k,m as i,k as o,a0 as h,F as p,$ as g,o as d,Q as A,l as a}from"./main-Do982A-Y.js";const w={name:"IntegrationPage",data(){return{showDropdown:!1,connectedAccounts:[],cards:[{id:1,title:"Facebook Integration",description:"Lead Ads Integration for Facebook."},{id:2,title:"Google Integration",description:"Lead Ads Integration for Google Ads."},{id:3,title:"TikTok Integration",description:"Lead Ads Integration for TikTok Ads."}]}},mounted(){this.loadConnectedAccounts()},methods:{toggleDropdown(){this.showDropdown=!this.showDropdown},handleIntegration(t){this.showDropdown=!1;const e={"Facebook Ads":"https://www.facebook.com/v18.0/dialog/oauth?client_id=983501733459311&redirect_uri=https://jsithub.com/test&response_type=token&scope=public_profile,email&display=popup","Google Ads":"https://accounts.google.com/o/oauth2/auth?client_id=932644499351-u8hu1a2885v7277npsisd0u31mopjulc.apps.googleusercontent.com&redirect_uri=http://127.0.0.1:8000/&response_type=token&scope=https://www.googleapis.com/auth/adwords&state=google_ads","TikTok Ads":"https://www.tiktok.com/auth/authorize/?client_key=sbawn1r29tozo1b810&redirect_uri=http://127.0.0.1:8000/callback/tiktok&response_type=code&scope=advertiser.read&state=tiktok_ads"};e[t]?this.openOAuthPopup(t,e[t]):alert(`Integration for ${t} is under development.`)},openOAuthPopup(t,e){const n=window.open(e,`${t} Login`,"width=600,height=700"),l=setInterval(()=>{try{if(n&&n.location.href.includes("code=")){const c=this.extractAuthCode(n.location.href);c&&(n.close(),clearInterval(l),this.exchangeCodeForToken(t,c))}}catch{}},1e3)},extractAuthCode(t){const e=t.match(/code=([^&]+)/);return e?e[1]:null},exchangeCodeForToken(t,e){fetch(`/api/oauth/${t.toLowerCase()}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e})}).then(n=>n.json()).then(n=>{n.access_token?(this.connectedAccounts.push({platform:t,token:n.access_token}),this.saveConnectedAccounts()):alert("Failed to get access token.")}).catch(n=>console.error("OAuth Error:",n))},saveConnectedAccounts(){localStorage.setItem("connectedAccounts",JSON.stringify(this.connectedAccounts))},loadConnectedAccounts(){const t=localStorage.getItem("connectedAccounts");t&&(this.connectedAccounts=JSON.parse(t))},removeAccount(t){this.connectedAccounts.splice(t,1),this.saveConnectedAccounts()}}},_={class:"container"},m={class:"header"},v={key:0,class:"dropdown"},f={key:0,class:"connected-accounts"},C=["onClick"],I={class:"cards-container"};function b(t,e,n,l,c,r){return d(),i("div",_,[o("div",m,[e[4]||(e[4]=o("h1",null,"Integration",-1)),o("button",{onClick:e[0]||(e[0]=(...s)=>r.toggleDropdown&&r.toggleDropdown(...s))},"+ Add New"),c.showDropdown?(d(),i("div",v,[o("ul",null,[o("li",{onClick:e[1]||(e[1]=s=>r.handleIntegration("Facebook Ads"))},"Facebook Ads"),o("li",{onClick:e[2]||(e[2]=s=>r.handleIntegration("Google Ads"))},"Google Ads"),o("li",{onClick:e[3]||(e[3]=s=>r.handleIntegration("TikTok Ads"))},"TikTok Ads")])])):h("",!0)]),c.connectedAccounts.length?(d(),i("div",f,[e[5]||(e[5]=o("h2",null,"Connected Accounts",-1)),o("ul",null,[(d(!0),i(p,null,g(c.connectedAccounts,(s,u)=>(d(),i("li",{key:u},[A(a(s.platform)+" - "+a(s.token.substring(0,15))+"... ",1),o("button",{onClick:y=>r.removeAccount(u)},"Remove",8,C)]))),128))])])):h("",!0),o("div",I,[(d(!0),i(p,null,g(c.cards,s=>(d(),i("div",{class:"card",key:s.id},[o("h2",null,a(s.title),1),o("p",null,a(s.description),1)]))),128))])])}const F=k(w,[["render",b],["__scopeId","data-v-3b0deabf"]]);export{F as default};
