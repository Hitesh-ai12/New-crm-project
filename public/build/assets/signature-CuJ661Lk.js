import{a as l}from"./axios-CdtiCRuU.js";import{S as w}from"./sweetalert2.all-B3MH3p00.js";import{t as u}from"./tinymce-Bml8Ic8q.js";import{_ as y,l as r,j as i,P as h,F as f,Y as S,L as g,Z as _,bn as v,bp as C,k as d,n as T,X as m,o}from"./main-B1XrQ5dN.js";import"./_commonjsHelpers-Cpj98o6Y.js";const k={data(){return{signatures:[],newSignature:{name:"",content:"",is_default:!1,id:null},defaultSignature:null,toastMessage:"",toastType:""}},computed:{sortedSignatures(){return[...this.signatures].sort((t,e)=>e.is_default-t.is_default)}},mounted(){this.fetchSignatures(),this.initTinyMCE()},activated(){this.reinitializeTinyMCE()},methods:{async fetchSignatures(){var t;try{const e=await l.get("/api/signatures");this.signatures=e.data,this.signatures.length>0&&(this.defaultSignature=((t=this.signatures.find(c=>c.is_default))==null?void 0:t.id)||this.signatures[0].id)}catch(e){console.error("Error fetching signatures:",e),this.showToast("Error fetching signatures.","error")}},async saveSignature(){const t=u.get("signature-editor").getContent();this.newSignature.content=t;try{this.newSignature.id?(await l.put(`/api/signatures/${this.newSignature.id}`,this.newSignature),this.showToast("Signature updated successfully!","success")):(await l.post("/api/signatures",this.newSignature),this.showToast("Signature added successfully!","success")),await this.fetchSignatures(),this.resetForm()}catch(e){console.error("Error saving signature:",e),this.showToast("Error saving signature.","error")}},selectSignature(t){this.newSignature.id=t.id,this.newSignature.name=t.name,this.newSignature.is_default=t.is_default,u.get("signature-editor").setContent(t.content)},confirmDeleteSignature(t){w.fire({title:"Are you sure?",text:"Do you really want to delete this signature?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No"}).then(async e=>{e.isConfirmed&&this.deleteSignature(t)})},async deleteSignature(t){try{await l.delete(`/api/signatures/${t}`),await this.fetchSignatures(),this.showToast("Signature deleted successfully!","success")}catch(e){console.error("Error deleting signature:",e),this.showToast("Error deleting signature.","error")}},async updateDefaultSignature(){try{await l.post("/api/signatures/set-default",{id:this.defaultSignature}),await this.fetchSignatures(),this.showToast("Default signature updated successfully!","success")}catch(t){console.error("Error setting default signature:",t),this.showToast("Error setting default signature.","error")}},showToast(t,e){this.toastMessage=t,this.toastType=e,setTimeout(()=>{this.toastMessage=""},3e3)},initTinyMCE(){u.init({selector:"#signature-editor",menubar:!1,plugins:"lists link",toolbar:"bold italic underline | alignleft aligncenter alignright | bullist numlist | link",setup:t=>{t.on("change",()=>{this.newSignature.content=t.getContent()})}})},reinitializeTinyMCE(){u.get("signature-editor")&&u.get("signature-editor").remove(),this.initTinyMCE()},resetForm(){this.newSignature={name:"",content:"",is_default:!1,id:null},u.get("signature-editor").setContent("")}}},M={class:"signature-container"},b={class:"signature-section"},E={class:"signature-list"},x={class:"singnature_heading"},D=["onClick"],B={class:"show_defaultSinature"},V={class:"signature-name"},N={key:0,class:"default-tag"},F=["onClick"],U={class:"dropdown_signature"},z=["value"],A={class:"signature-editor"};function L(t,e,c,Y,n,a){return o(),r("div",M,[i("div",b,[i("div",E,[i("h3",x,[e[6]||(e[6]=h("Signatures ")),i("button",{onClick:e[0]||(e[0]=(...s)=>t.openAddModal&&t.openAddModal(...s))},"+")]),i("ul",null,[(o(!0),r(f,null,S(a.sortedSignatures,(s,j)=>(o(),r("li",{key:s.id,onClick:p=>a.selectSignature(s)},[i("div",B,[i("span",V,d(s.name),1),s.is_default?(o(),r("span",N,"Default")):m("",!0),i("button",{onClick:p=>a.confirmDeleteSignature(s.id)},"ğŸ—‘",8,F)])],8,D))),128))]),i("div",U,[e[7]||(e[7]=i("label",null,"Set Default Signature",-1)),g(i("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>n.defaultSignature=s),onChange:e[2]||(e[2]=(...s)=>a.updateDefaultSignature&&a.updateDefaultSignature(...s))},[(o(!0),r(f,null,S(n.signatures,s=>(o(),r("option",{key:s.id,value:s.id},d(s.name),9,z))),128))],544),[[_,n.defaultSignature]])])]),i("div",A,[e[9]||(e[9]=i("h3",null,"Edit Signature",-1)),g(i("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>n.newSignature.name=s),placeholder:"Signature Name"},null,512),[[v,n.newSignature.name]]),i("label",null,[e[8]||(e[8]=h(" Set as default ")),g(i("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=s=>n.newSignature.is_default=s)},null,512),[[C,n.newSignature.is_default]])]),e[10]||(e[10]=i("textarea",{id:"signature-editor"},null,-1)),i("button",{onClick:e[5]||(e[5]=(...s)=>a.saveSignature&&a.saveSignature(...s))},d(n.newSignature.id?"Update":"Create")+" Signature",1)])]),n.toastMessage?(o(),r("div",{key:0,class:T(["toast",n.toastType,{show:n.toastMessage}])},d(n.toastMessage),3)):m("",!0)])}const G=y(k,[["render",L],["__scopeId","data-v-7a0ebd6b"]]);export{G as default};
