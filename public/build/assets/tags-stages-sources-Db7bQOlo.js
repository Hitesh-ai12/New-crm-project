import{a as h}from"./axios-CdtiCRuU.js";import{S as b}from"./sweetalert2.all-DyJFIm0t.js";import{r as u,R as I,_ as L,l as v,j as l,F as T,Y as w,k as m,L as N,d6 as F,X as x,o as g,P as S}from"./main-DK1TH9pn.js";import"./_commonjsHelpers-BosuxZz1.js";h.interceptors.request.use(n=>{const e=localStorage.getItem("auth_token");return e&&(n.headers.Authorization=`Bearer ${e}`),n});function P(){const n=u([]),e=u([]),c=u([]),s=u(!1),i=u(""),p=u(!1),a=u(""),r=u(null),d=u(!1),_=u(""),y=async()=>{try{const o=(await h.get("/api/items")).data;n.value=o.tags||[],e.value=o.stages||[],c.value=o.sources||[]}catch(t){console.error("Error fetching items:",t)}},M=(t,o=null)=>{i.value=t,o?(p.value=!0,a.value=o.name,r.value=o):(p.value=!1,a.value="",r.value=null),s.value=!0},k=()=>{s.value=!1},E=async()=>{if(a.value.trim()===""){alert(`Please enter a valid ${i.value}.`);return}try{if(p.value&&r.value){const o=(await h.put(`/api/items/${r.value.id}`,{name:a.value})).data.item;D(i.value,o),C(`${i.value} updated successfully!`)}else{const o=(await h.post("/api/items",{name:a.value,type:i.value})).data.item;V(i.value,o),C(`${i.value} added successfully!`)}k()}catch(t){console.error("Error saving item:",t),alert("There was an error saving your data.")}},D=(t,o)=>{t==="tag"?n.value=n.value.map(f=>f.id===o.id?o:f):t==="stage"?e.value=e.value.map(f=>f.id===o.id?o:f):t==="source"&&(c.value=c.value.map(f=>f.id===o.id?o:f))},V=(t,o)=>{t==="tag"?n.value.push(o):t==="stage"?e.value.push(o):t==="source"&&c.value.push(o)},A=t=>{b.fire({title:`Are you sure you want to delete this ${t.type}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, Delete",cancelButtonText:"No, Cancel"}).then(async o=>{o.isConfirmed&&await B(t)})},B=async t=>{try{await h.delete(`/api/items/${t.id}`),t.type==="tag"?n.value=n.value.filter(o=>o.id!==t.id):t.type==="stage"?e.value=e.value.filter(o=>o.id!==t.id):t.type==="source"&&(c.value=c.value.filter(o=>o.id!==t.id)),C("Item deleted successfully!")}catch(o){console.error("Error deleting item:",o),alert("There was an error deleting your data.")}},C=t=>{_.value=t,d.value=!0,setTimeout(()=>d.value=!1,3e3)};return I(()=>{y()}),{tags:n,stages:e,sources:c,showModal:s,modalType:i,modalEditMode:p,inputValue:a,openModal:M,closeModal:k,saveItem:E,showToast:d,toastMessage:_,confirmDelete:A}}const U={setup(){const{tags:n,stages:e,sources:c,showModal:s,modalType:i,modalEditMode:p,inputValue:a,openModal:r,closeModal:d,saveItem:_,showToast:y,toastMessage:M,confirmDelete:k}=P();return{tags:n,stages:e,sources:c,showModal:s,modalType:i,modalEditMode:p,inputValue:a,openModal:r,closeModal:d,saveItem:_,showToast:y,toastMessage:M,confirmDelete:k}}},Y={class:"cards-container"},j={class:"card"},q={class:"tags"},z={class:"tag-icons"},R=["onClick"],X=["onClick"],G={class:"card"},H={class:"stages"},J={class:"tag-icons"},K=["onClick"],O=["onClick"],Q={class:"card"},W={class:"sources"},Z={class:"tag-icons"},$=["onClick"],ee=["onClick"],se={key:0,class:"modal"},oe={class:"modal-content"},ae=["placeholder"],te={class:"modal-actions"},le={key:1,class:"toast"};function ne(n,e,c,s,i,p){return g(),v("div",null,[e[9]||(e[9]=l("h1",{class:"tss-class"},"Tags | Stage | Source",-1)),l("div",Y,[l("div",j,[e[6]||(e[6]=l("h3",null,"Tags",-1)),l("div",q,[(g(!0),v(T,null,w(s.tags,(a,r)=>(g(),v("span",{key:a.id,class:"tag"},[l("div",z,[l("span",{class:"tag-icon",onClick:d=>s.openModal("tag",a)},"âœï¸",8,R),l("span",{class:"delete-icon",onClick:d=>s.confirmDelete(a)},"ðŸ—‘ï¸",8,X)]),S(" "+m(a.name),1)]))),128)),l("button",{onClick:e[0]||(e[0]=a=>s.openModal("tag"))},"âž• Add Tag")])]),l("div",G,[e[7]||(e[7]=l("h3",null,"Stage",-1)),l("div",H,[(g(!0),v(T,null,w(s.stages,(a,r)=>(g(),v("span",{key:r,class:"stage"},[l("div",J,[l("span",{class:"tag-icon",onClick:d=>s.openModal("stage",a)},"âœï¸",8,K),l("span",{class:"delete-icon",onClick:d=>s.confirmDelete(a)},"ðŸ—‘ï¸",8,O)]),S(" "+m(a.name),1)]))),128)),l("button",{onClick:e[1]||(e[1]=a=>s.openModal("stage"))},"âž• Add Stage")])]),l("div",Q,[e[8]||(e[8]=l("h3",null,"Source",-1)),l("div",W,[(g(!0),v(T,null,w(s.sources,(a,r)=>(g(),v("span",{key:r,class:"source"},[l("div",Z,[l("span",{class:"tag-icon",onClick:d=>s.openModal("source",a)},"âœï¸",8,$),l("span",{class:"delete-icon",onClick:d=>s.confirmDelete(a)},"ðŸ—‘ï¸",8,ee)]),S(" "+m(a.name),1)]))),128)),l("button",{onClick:e[2]||(e[2]=a=>s.openModal("source"))},"âž• Add Source")])])]),s.showModal?(g(),v("div",se,[l("div",oe,[l("h3",null,m(s.modalEditMode?"Edit":"Add")+" "+m(s.modalType),1),N(l("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=a=>s.inputValue=a),placeholder:"Enter "+s.modalType},null,8,ae),[[F,s.inputValue]]),l("div",te,[l("button",{onClick:e[4]||(e[4]=(...a)=>s.saveItem&&s.saveItem(...a))},m(s.modalEditMode?"Update":"Add")+" "+m(s.modalType),1),l("button",{onClick:e[5]||(e[5]=(...a)=>s.closeModal&&s.closeModal(...a))},"Close")])])])):x("",!0),s.showToast?(g(),v("div",le,m(s.toastMessage),1)):x("",!0)])}const ue=L(U,[["render",ne]]);export{ue as default};
