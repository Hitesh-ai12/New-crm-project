import"./bootstrap.min-KxrJAQL6.js";import{_ as T,r as m,R as j,o as n,l as i,j as e,P as b,k as d,X as G,e as W,L as Y,Y as Z,h as N,g as z,n as $,u as q,F as k,Z as S,f as R,$ as C}from"./main-12_IZHkA.js";import{a as x}from"./axios-CdtiCRuU.js";import{d as X}from"./vuedraggable.umd-BwoJ3G_K.js";import"./_commonjsHelpers-BosuxZz1.js";const H={class:"container-fluid"},J={class:"row"},K={class:"col-md-3"},Q={class:"card-box leads"},ee={class:"d-flex justify-content-between"},se={class:"inner-card"},te={class:"inner-card"},ae={class:"card-box action-plan"},le={class:"d-flex justify-content-start"},oe={class:"inner-card w-100"},ne={class:"card-box inbox"},ie={class:"d-flex justify-content-between"},de={class:"inner-card"},re={class:"inner-card"},ce={class:"card-box todays-events"},ue={class:"d-flex justify-content-between"},me={class:"inner-card"},ve={class:"inner-card"},be={__name:"AnalyticsBarCharts",setup(P){const p={today:0,active:3},o={active:0},v=m({sms:0,email:0}),r=m({tasks:0,appointments:0}),f=async()=>{try{const s=await(await fetch("/api/events/today-counts",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}})).json();r.value.tasks=s.tasks,r.value.appointments=s.appointments}catch(c){console.error("âŒ Failed to fetch today's event counts:",c)}},_=async()=>{try{const s=await(await fetch("/api/dashboard/message-counts",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}})).json();v.value.sms=s.sms,v.value.email=s.email}catch(c){console.error("âŒ Failed to fetch inbox counts:",c)}};return j(()=>{f(),_()}),(c,s)=>(n(),i("div",H,[e("div",J,[e("div",K,[e("div",Q,[s[2]||(s[2]=e("div",{class:"card-title"},[e("i",{class:"bi bi-people-fill me-1"}),b(" Leads")],-1)),e("div",ee,[e("div",se,[s[0]||(s[0]=e("span",null,"Today",-1)),e("strong",null,d(p.today),1)]),e("div",te,[s[1]||(s[1]=e("span",null,"Active",-1)),e("strong",null,d(p.active),1)])])]),e("div",ae,[s[4]||(s[4]=e("div",{class:"card-title"},[e("i",{class:"bi bi-stickies-fill me-1"}),b(" Action Plan")],-1)),e("div",le,[e("div",oe,[s[3]||(s[3]=e("span",null,"Active",-1)),e("strong",null,d(o.active),1)])])]),e("div",ne,[s[7]||(s[7]=e("div",{class:"card-title"},[e("i",{class:"bi bi-inbox-fill me-1"}),b(" Inbox")],-1)),e("div",ie,[e("div",de,[s[5]||(s[5]=e("span",null,"E-Mail",-1)),e("strong",null," : "+d(v.value.email),1)]),e("div",re,[s[6]||(s[6]=e("span",null,"SMS",-1)),e("strong",null," : "+d(v.value.sms),1)])])]),e("div",ce,[s[10]||(s[10]=e("div",{class:"card-title"},[e("i",{class:"bi bi-calendar-event-fill me-1"}),b(" Todays Events")],-1)),e("div",ue,[e("div",me,[s[8]||(s[8]=e("span",null,"Tasks",-1)),e("strong",null," : "+d(r.value.tasks),1)]),e("div",ve,[s[9]||(s[9]=e("span",null,"Appointments",-1)),e("strong",null," : "+d(r.value.appointments),1)])])])]),s[11]||(s[11]=G('<div class="col-md-9" data-v-68dd85cf><div id="dashboardCarousel" class="carousel slide" data-bs-ride="carousel" data-v-68dd85cf><div class="carousel-inner rounded shadow" data-v-68dd85cf><div class="carousel-item active" data-v-68dd85cf><img src="/storage/attachments/CSt6OyZ1AYP7WsDCGoqr3nLsrGPlffUNUzfbNeel.jpg" class="d-block w-100" alt="Ad 1" data-v-68dd85cf></div><div class="carousel-item" data-v-68dd85cf><img src="/storage/attachments/CSt6OyZ1AYP7WsDCGoqr3nLsrGPlffUNUzfbNeel.jpg" class="d-block w-100" alt="Ad 2" data-v-68dd85cf></div><div class="carousel-item" data-v-68dd85cf><img src="/storage/attachments/CSt6OyZ1AYP7WsDCGoqr3nLsrGPlffUNUzfbNeel.jpg" class="d-block w-100" alt="Ad 3" data-v-68dd85cf></div></div></div></div>',1))])]))}},pe=T(be,[["__scopeId","data-v-68dd85cf"]]),ge={class:"container mt-4"},fe={class:"mb-3 d-flex align-items-center gap-2"},_e={class:"table-container table-responsive"},he={class:"table-wrapper"},ye={class:"table table-bordered table-striped align-middle lead_Table"},ke={class:"table-light"},Ce={key:0,class:"alert alert-warning mt-3"},xe={class:"pagination d-flex justify-content-center align-items-center gap-3 mt-4"},we=["disabled"],Ae=["disabled"],$e={key:2,class:"columns-modal-overlay"},Se={class:"columns-modal-container"},Ne={class:"columns-modal-list list-unstyled mb-3"},Pe=["checked","onChange","disabled"],Le={class:"form-check-label mb-0"},ze={key:0,class:"text-danger fw-semibold"},Te={class:"d-flex justify-content-end gap-2"},je=["disabled"],Be={__name:"LeadsTable",setup(P){const p=m([]),o=m([]),v=m(!1),r=m(1),f=m(1),_=m(10),c=m({message:"",type:""}),s=localStorage.getItem("auth_token"),h=m({first_name:{label:"Name",disabled:!0},email:{label:"Email",disabled:!0},phone:{label:"Phone",disabled:!0},latest_activity:{label:"Latest Activity"},activity_at:{label:"Activity At"},created_on:{label:"Created On"},tags:{label:"Tags"},stage:{label:"Stage"},latest_source:{label:"Latest Source"},latest_sms:{label:"Latest SMS"},latest_email:{label:"Latest Email"},next_task:{label:"Next Task"},next_appointment:{label:"Next Appointment"},new_listing_alert:{label:"New Listing Alerts"},neighbourhood_alert:{label:"Neighbourhood Alerts"},price_drop_alert:{label:"Price Drop Alerts"},action_plans:{label:"Active Action Plans"},market_updates:{label:"Assigned Market Updates"},real_estate_newsletter:{label:"Assigned Newsletters"},notes:{label:"Notes"},dob:{label:"DOB"},background:{label:"Background"},city:{label:"City"},facebook:{label:"Facebook"},instagram:{label:"Instagram"},linkedin:{label:"LinkedIn"},whatsapp:{label:"WhatsApp"},twitter:{label:"Twitter"}}),w=async()=>{try{const a=await x.get("/api/leads",{params:{page:r.value,perPage:_.value},headers:{Authorization:`Bearer ${s}`}});p.value=a.data.data||a.data,f.value=a.data.last_page||1}catch{g("Failed to fetch leads","error")}},L=a=>{a>0&&a<=f.value&&(r.value=a,w())},B=a=>{_.value=a,r.value=1,w()},g=(a,t="success")=>{c.value={message:a,type:t},setTimeout(()=>c.value.message="",3e3)},V=()=>v.value=!0,A=()=>v.value=!1,I=a=>{if(!h.value[a].disabled){const t=o.value.indexOf(a);t===-1?(o.value.push(a),g(`Column "${h.value[a].label}" added`)):(o.value.splice(t,1),g(`Column "${h.value[a].label}" removed`))}},M=async()=>{await E(),A()},U=async()=>{await F()},D=async()=>{try{const a=await x.get("/api/columns-settings",{headers:{Authorization:`Bearer ${s}`}});o.value=Array.isArray(a.data.selectedColumns)?a.data.selectedColumns:["first_name","email","phone"]}catch(a){console.error("ðŸ”´ Error fetching column settings",a),o.value=["first_name","email","phone"]}},E=async()=>{try{await x.post("/api/columns-settings",{selectedColumns:o.value},{headers:{Authorization:`Bearer ${s}`}}),g("Column visibility saved")}catch{g("Failed to save column visibility","error")}},F=async()=>{try{await x.post("/api/columns-order",{selectedColumns:o.value},{headers:{Authorization:`Bearer ${s}`}}),g("Column order saved")}catch{g("Failed to save column order","error")}};return j(()=>{w(),D()}),(a,t)=>{const O=W("router-link");return n(),i("div",ge,[e("div",fe,[t[7]||(t[7]=e("label",{for:"pageSize",class:"form-label mb-0"},"Rows per page:",-1)),Y(e("select",{id:"pageSize",class:"form-select form-select-sm w-auto","onUpdate:modelValue":t[0]||(t[0]=l=>_.value=l),onChange:t[1]||(t[1]=l=>B(Number(l.target.value)))},t[6]||(t[6]=[e("option",{value:"5"},"5",-1),e("option",{value:"10"},"10",-1),e("option",{value:"25"},"25",-1),e("option",{value:"50"},"50",-1)]),544),[[Z,_.value]])]),e("div",_e,[e("div",he,[e("table",ye,[e("thead",ke,[e("tr",null,[e("th",{class:"checkbox-col"},[e("label",{class:"custom-checkbox-label d-flex align-items-center gap-1"},[e("li",{class:"total-leads list-unstyled mb-0 d-flex align-items-center gap-1",onClick:V},t[8]||(t[8]=[e("span",null,"Settings",-1),e("i",{class:"fa-solid fa-gear"},null,-1)])),t[9]||(t[9]=e("span",{class:"custom-checkbox-span"},null,-1))])]),N(q(X),{modelValue:o.value,"onUpdate:modelValue":t[2]||(t[2]=l=>o.value=l),tag:"tr","item-key":"col",handle:".drag-handle",onEnd:U},{item:z(({element:l,index:u})=>{var y;return[e("th",{class:$(["text-nowrap",{"scroll-column":u>=6}])},[t[10]||(t[10]=e("span",{class:"drag-handle me-1 cursor-move"},"â˜°",-1)),b(" "+d(((y=h.value[l])==null?void 0:y.label)||l),1)],2)]}),_:1},8,["modelValue"])])]),e("tbody",null,[(n(!0),i(k,null,S(p.value,l=>(n(),i("tr",{key:l.id},[(n(!0),i(k,null,S(o.value,(u,y)=>(n(),i("td",{key:u,class:$(["text-nowrap",{"scroll-column":y>=6}])},[u==="first_name"?(n(),R(O,{key:0,to:"/update-profile/"+l.id,class:"text-decoration-none fw-bold text-primary"},{default:z(()=>[b(d(l[u]||"N/A"),1)]),_:2},1032,["to"])):(n(),i(k,{key:1},[b(d(l[u]||"N/A"),1)],64))],2))),128))]))),128))])])])]),p.value.length===0?(n(),i("div",Ce,"No leads available.")):C("",!0),c.value.message?(n(),i("div",{key:1,class:$(`alert alert-${c.value.type==="success"?"success":"danger"} d-flex justify-content-between align-items-center mt-3`),role:"alert"},[b(d(c.value.message)+" ",1),e("button",{onClick:t[3]||(t[3]=l=>c.value.message=""),type:"button",class:"btn-close","aria-label":"Close"})],2)):C("",!0),e("div",xe,[e("button",{class:"btn btn-outline-primary btn-sm",onClick:t[4]||(t[4]=l=>L(r.value-1)),disabled:r.value===1}," Previous ",8,we),e("span",null,"Page "+d(r.value)+" of "+d(f.value),1),e("button",{class:"btn btn-outline-primary btn-sm",onClick:t[5]||(t[5]=l=>L(r.value+1)),disabled:r.value===f.value}," Next ",8,Ae)]),v.value?(n(),i("div",$e,[e("div",Se,[e("span",{class:"columns-modal-close",onClick:A},"Ã—"),t[11]||(t[11]=e("h5",{class:"mb-3"},"Select and Arrange Columns",-1)),e("ul",Ne,[(n(!0),i(k,null,S(h.value,(l,u)=>(n(),i("li",{key:u,class:"columns-modal-item d-flex align-items-center gap-2"},[e("input",{type:"checkbox",class:"form-check-input",checked:o.value.includes(u),onChange:y=>I(u),disabled:l.disabled},null,40,Pe),e("label",Le,d(l.label),1)]))),128))]),o.value.length===0?(n(),i("p",ze," âš ï¸ Please select at least one column! ")):C("",!0),e("div",Te,[e("button",{class:"btn btn-primary btn-sm",onClick:M,disabled:o.value.length===0}," Save ",8,je),e("button",{class:"btn btn-secondary btn-sm",onClick:A}," Cancel ")])])])):C("",!0)])}}},Ve=T(Be,[["__scopeId","data-v-02c50e30"]]),Fe={__name:"dashboard",setup(P){return(p,o)=>(n(),i(k,null,[N(pe),N(Ve)],64))}};export{Fe as default};
