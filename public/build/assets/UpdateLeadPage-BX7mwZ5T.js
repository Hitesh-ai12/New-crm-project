import"./bootstrap.min-KxrJAQL6.js";import{o as p,l as v,j as e,_ as D,r as k,bf as H,L as a,d6 as r,d3 as x,aG as q,U as z,R as O,b as j,n as g,Z as W,X as f,F as R,Y as P,k as c,P as w,f as V}from"./main-C6XlpVDT.js";import{a as S}from"./axios-CdtiCRuU.js";const _={__name:"AnalyticsTab",setup(U){return(i,l)=>(p(),v("div",null,l[0]||(l[0]=[e("h4",{class:"mb-3"},"Analytics",-1),e("p",null,"No analytics data available yet.",-1)])))}},Z={class:"row g-3"},G={class:"col-md-6"},J={class:"col-md-6"},X={class:"col-md-6"},Y={class:"col-md-6"},K={class:"col-md-6"},Q={class:"col-md-6"},h={class:"col-md-6"},ee={class:"col-md-6"},te={class:"col-md-6"},le={class:"col-md-6"},se={class:"col-md-6"},oe={class:"col-md-6"},ne={class:"col-md-6"},ae={class:"col-md-6 form-check"},ie={class:"col-md-6 form-check"},de={class:"col-md-6 form-check"},re={class:"col-md-6 form-check"},me={class:"col-md-6"},ue={class:"col-md-6"},pe={class:"col-md-6"},ve={class:"col-md-6"},ce={class:"col-md-6"},be={class:"col-md-6"},fe={class:"col-md-6"},ge={class:"col-md-6"},ye={class:"col-md-6"},ke={class:"col-md-6"},$e={class:"col-md-6"},Ae={class:"col-md-6"},xe={class:"col-md-6"},Se={class:"col-md-6"},Ue={class:"col-md-6"},we={class:"col-md-6"},Ve={__name:"ProfileTab",setup(U){const i=k("123"),l=H({name:"",email:"",phone:"",latestActivity:"",activityAt:"",createdOn:"",tags:"",stage:"",latestSource:"",latestSMS:"",latestEmail:"",nextTask:"",nextAppointment:"",newListingAlerts:!1,neighbourhoodAlerts:!1,openHouseAlerts:!1,priceDropAlerts:!1,activeActionPlans:"",assignedMarketUpdates:"",assignedNewsletters:"",notes:"",dob:"",background:"",city:"",facebook:"",instagram:"",linkedin:"",whatsapp:"",twitter:"",house_number:"",street:"",province:"",zip_code:""});function y(){console.log("Lead data:",l),alert("Lead Updated Successfully!")}return(u,t)=>(p(),v("form",{onSubmit:q(y,["prevent"])},[a(e("input",{type:"hidden","onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s)},null,512),[[r,i.value]]),t[68]||(t[68]=e("h4",{class:"mb-3"},"Profile",-1)),e("div",Z,[e("div",G,[t[34]||(t[34]=e("label",{class:"form-label"},"Name",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>l.name=s),class:"form-control",required:""},null,512),[[r,l.name]])]),e("div",J,[t[35]||(t[35]=e("label",{class:"form-label"},"Email",-1)),a(e("input",{type:"email","onUpdate:modelValue":t[2]||(t[2]=s=>l.email=s),class:"form-control",required:""},null,512),[[r,l.email]])]),e("div",X,[t[36]||(t[36]=e("label",{class:"form-label"},"Phone",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=s=>l.phone=s),class:"form-control",required:""},null,512),[[r,l.phone]])]),e("div",Y,[t[37]||(t[37]=e("label",{class:"form-label"},"Latest Activity",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=s=>l.latestActivity=s),class:"form-control"},null,512),[[r,l.latestActivity]])]),e("div",K,[t[38]||(t[38]=e("label",{class:"form-label"},"Activity At",-1)),a(e("input",{type:"date","onUpdate:modelValue":t[5]||(t[5]=s=>l.activityAt=s),class:"form-control"},null,512),[[r,l.activityAt]])]),e("div",Q,[t[39]||(t[39]=e("label",{class:"form-label"},"Created On",-1)),a(e("input",{type:"date","onUpdate:modelValue":t[6]||(t[6]=s=>l.createdOn=s),class:"form-control"},null,512),[[r,l.createdOn]])]),e("div",h,[t[40]||(t[40]=e("label",{class:"form-label"},"Tags",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=s=>l.tags=s),class:"form-control"},null,512),[[r,l.tags]])]),e("div",ee,[t[41]||(t[41]=e("label",{class:"form-label"},"Stage",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=s=>l.stage=s),class:"form-control"},null,512),[[r,l.stage]])]),e("div",te,[t[42]||(t[42]=e("label",{class:"form-label"},"Latest Source",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=s=>l.latestSource=s),class:"form-control"},null,512),[[r,l.latestSource]])]),e("div",le,[t[43]||(t[43]=e("label",{class:"form-label"},"Latest SMS",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=s=>l.latestSMS=s),class:"form-control"},null,512),[[r,l.latestSMS]])]),e("div",se,[t[44]||(t[44]=e("label",{class:"form-label"},"Latest Email",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=s=>l.latestEmail=s),class:"form-control"},null,512),[[r,l.latestEmail]])]),e("div",oe,[t[45]||(t[45]=e("label",{class:"form-label"},"Next Task",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[12]||(t[12]=s=>l.nextTask=s),class:"form-control"},null,512),[[r,l.nextTask]])]),e("div",ne,[t[46]||(t[46]=e("label",{class:"form-label"},"Next Appointment",-1)),a(e("input",{type:"date","onUpdate:modelValue":t[13]||(t[13]=s=>l.nextAppointment=s),class:"form-control"},null,512),[[r,l.nextAppointment]])]),e("div",ae,[a(e("input",{type:"checkbox","onUpdate:modelValue":t[14]||(t[14]=s=>l.newListingAlerts=s),class:"form-check-input"},null,512),[[x,l.newListingAlerts]]),t[47]||(t[47]=e("label",{class:"form-check-label"},"New Listing Alerts",-1))]),e("div",ie,[a(e("input",{type:"checkbox","onUpdate:modelValue":t[15]||(t[15]=s=>l.neighbourhoodAlerts=s),class:"form-check-input"},null,512),[[x,l.neighbourhoodAlerts]]),t[48]||(t[48]=e("label",{class:"form-check-label"},"Neighbourhood Alerts",-1))]),e("div",de,[a(e("input",{type:"checkbox","onUpdate:modelValue":t[16]||(t[16]=s=>l.openHouseAlerts=s),class:"form-check-input"},null,512),[[x,l.openHouseAlerts]]),t[49]||(t[49]=e("label",{class:"form-check-label"},"Open House Alerts",-1))]),e("div",re,[a(e("input",{type:"checkbox","onUpdate:modelValue":t[17]||(t[17]=s=>l.priceDropAlerts=s),class:"form-check-input"},null,512),[[x,l.priceDropAlerts]]),t[50]||(t[50]=e("label",{class:"form-check-label"},"Price Drop Alerts",-1))]),e("div",me,[t[51]||(t[51]=e("label",{class:"form-label"},"Active Action Plans",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[18]||(t[18]=s=>l.activeActionPlans=s),class:"form-control"},null,512),[[r,l.activeActionPlans]])]),e("div",ue,[t[52]||(t[52]=e("label",{class:"form-label"},"Assigned Market Updates",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[19]||(t[19]=s=>l.assignedMarketUpdates=s),class:"form-control"},null,512),[[r,l.assignedMarketUpdates]])]),e("div",pe,[t[53]||(t[53]=e("label",{class:"form-label"},"Assigned Newsletters",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[20]||(t[20]=s=>l.assignedNewsletters=s),class:"form-control"},null,512),[[r,l.assignedNewsletters]])]),e("div",ve,[t[54]||(t[54]=e("label",{class:"form-label"},"Notes",-1)),a(e("textarea",{"onUpdate:modelValue":t[21]||(t[21]=s=>l.notes=s),class:"form-control"},null,512),[[r,l.notes]])]),e("div",ce,[t[55]||(t[55]=e("label",{class:"form-label"},"Background",-1)),a(e("textarea",{"onUpdate:modelValue":t[22]||(t[22]=s=>l.background=s),class:"form-control"},null,512),[[r,l.background]])]),e("div",be,[t[56]||(t[56]=e("label",{class:"form-label"},"Date of Birth",-1)),a(e("input",{type:"date","onUpdate:modelValue":t[23]||(t[23]=s=>l.dob=s),class:"form-control"},null,512),[[r,l.dob]])]),e("div",fe,[t[57]||(t[57]=e("label",{class:"form-label"},"House Number",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[24]||(t[24]=s=>l.house_number=s),class:"form-control",required:""},null,512),[[r,l.house_number]])]),e("div",ge,[t[58]||(t[58]=e("label",{class:"form-label"},"Street",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[25]||(t[25]=s=>l.street=s),class:"form-control",required:""},null,512),[[r,l.street]])]),e("div",ye,[t[59]||(t[59]=e("label",{class:"form-label"},"City",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[26]||(t[26]=s=>l.city=s),class:"form-control",required:""},null,512),[[r,l.city]])]),e("div",ke,[t[60]||(t[60]=e("label",{class:"form-label"},"Province",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[27]||(t[27]=s=>l.province=s),class:"form-control",required:""},null,512),[[r,l.province]])]),e("div",$e,[t[61]||(t[61]=e("label",{class:"form-label"},"Zip Code",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[28]||(t[28]=s=>l.zip_code=s),class:"form-control",required:""},null,512),[[r,l.zip_code]])]),e("div",Ae,[t[62]||(t[62]=e("label",{class:"form-label"},"Facebook",-1)),a(e("input",{type:"url","onUpdate:modelValue":t[29]||(t[29]=s=>l.facebook=s),class:"form-control"},null,512),[[r,l.facebook]])]),e("div",xe,[t[63]||(t[63]=e("label",{class:"form-label"},"Instagram",-1)),a(e("input",{type:"url","onUpdate:modelValue":t[30]||(t[30]=s=>l.instagram=s),class:"form-control"},null,512),[[r,l.instagram]])]),e("div",Se,[t[64]||(t[64]=e("label",{class:"form-label"},"LinkedIn",-1)),a(e("input",{type:"url","onUpdate:modelValue":t[31]||(t[31]=s=>l.linkedin=s),class:"form-control"},null,512),[[r,l.linkedin]])]),e("div",Ue,[t[65]||(t[65]=e("label",{class:"form-label"},"WhatsApp",-1)),a(e("input",{type:"text","onUpdate:modelValue":t[32]||(t[32]=s=>l.whatsapp=s),class:"form-control"},null,512),[[r,l.whatsapp]])]),e("div",we,[t[66]||(t[66]=e("label",{class:"form-label"},"Twitter",-1)),a(e("input",{type:"url","onUpdate:modelValue":t[33]||(t[33]=s=>l.twitter=s),class:"form-control"},null,512),[[r,l.twitter]])]),t[67]||(t[67]=e("div",{class:"col-12"},[e("button",{type:"submit",class:"btn btn-primary mt-3"},"Update")],-1))])],32))}},Te=D(Ve,[["__scopeId","data-v-e44d76b3"]]),Le={class:"container d-flex"},Me={class:"sidebar me-4"},Ce={class:"main-content flex-grow-1"},Ee={key:0,class:"mb-3"},Re={class:"card-body"},Pe={class:"card-title"},De={class:"card-text"},Ne={key:0},Ie={key:1},Fe={key:2},Be={key:3},He=["innerHTML"],qe={class:"text-muted small"},ze=["onClick"],Oe=["onClick"],je={key:1,class:"modal fade show d-block",tabindex:"-1",role:"dialog",style:{"background-color":"rgba(0, 0, 0, 50%)"}},We={class:"modal-dialog modal-lg",role:"document"},_e={class:"modal-content"},Ze={class:"modal-header"},Ge={class:"modal-title"},Je={class:"modal-body"},Xe={key:0},Ye=["innerHTML"],Ke={key:1},Qe=["href"],he={class:"modal-footer"},et={__name:"TimelineTab",setup(U){const i=k("all"),l=k("all");z();const y=k(!1),u=k({}),t=m=>{const o=new Date(m);return{date:o.toLocaleDateString(),time:o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}},s=k([{id:"web-1",type:"webActivity",title:"Visited Website",description:"User visited homepage",date:"2025-06-09",time:"10:30 AM"},{id:"email-received-1",type:"email",direction:"received",title:"Replied Email",description:"User replied to your email.",date:"2025-06-08",time:"6:10 PM"},{id:"sms-1",type:"sms",title:"Received SMS",description:"User received an SMS about a new listing",date:"2025-06-07",time:"1:15 PM"}]);O(async()=>{try{const m=localStorage.getItem("auth_token"),o={Authorization:`Bearer ${m}`},$=(await S.get("/api/sent-sms",{headers:o})).data.map(d=>{const{date:b,time:A}=t(d.sent_at);return{id:`sms-sent-${d.id}`,type:"sms",direction:"sent",phone:d.to,title:"Sent SMS",description:d.message,leadId:d.lead_id,date:b,time:A}}),B=(await S.get("/api/incoming-sms",{headers:o})).data.map(d=>{const{date:b,time:A}=t(d.received_at);return{id:`sms-rec-${d.id}`,type:"sms",direction:"received",phone:d.from,title:"Received SMS",description:d.message,leadId:d.lead_id,date:b,time:A}});s.value.push(...B,...$);const L=await S.get("/api/sent-emails",{headers:{Authorization:`Bearer ${m}`}});console.log("Raw Sent Emails API Response:",L.data);const M=L.data.map(d=>{const b=new Date(d.created_at);return{id:`sent-${d.id}`,type:"email",direction:"sent",title:"Sent Email",description:d.subject,date:b.toLocaleDateString(),time:b.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),to:d.to,body_plain:d.message,body_html:null,attachments:d.attachments}});console.log("Formatted Sent Emails:",M),s.value.push(...M);const C=await S.get("/api/received-emails",{headers:{Authorization:`Bearer ${m}`}});console.log("--- RECEIVED REPLIES (from DB) ---"),console.log("Raw Received Emails API Response:",C.data);const E=C.data.map(d=>{const b=new Date(d.received_at);return{id:`received-${d.id}`,type:"email",direction:"received",title:d.title,description:d.description,from:d.from,to:d.to,body_plain:d.body_plain,body_html:d.body_html,attachments:d.attachments,date:b.toLocaleDateString(),time:b.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}});console.log("Formatted Received Emails:",E),s.value.push(...E),s.value.sort((d,b)=>{const A=new Date(`${d.date} ${d.time}`);return new Date(`${b.date} ${b.time}`).getTime()-A.getTime()})}catch(m){console.error("Failed to load emails:",m),m.response&&m.response.status===401&&console.error("Authentication failed. Please log in again.")}});const N=j(()=>i.value==="all"?s.value:i.value==="email"||i.value==="sms"?s.value.filter(m=>m.type!==i.value?!1:l.value==="all"?!0:m.direction===l.value&&m.type===i.value):s.value.filter(m=>m.type===i.value)),T=m=>{alert(`Replying to: ${m.title} from ${m.from}. Full subject: ${m.description}`)},I=m=>{u.value=m,y.value=!0},F=m=>m.substring(m.lastIndexOf("/")+1);return(m,o)=>(p(),v("div",Le,[e("div",Me,[e("div",{class:g(["menu-item",{active:i.value==="all"}]),onClick:o[0]||(o[0]=n=>{i.value="all",l.value="all"})},o[10]||(o[10]=[e("div",{class:"icon"},[e("i",{class:"fas fa-headset"})],-1),e("div",{class:"label"},"ALL",-1)]),2),e("div",{class:g(["menu-item",{active:i.value==="sms"}]),onClick:o[1]||(o[1]=n=>{i.value="sms",l.value="all"})},o[11]||(o[11]=[e("div",{class:"icon"},[e("i",{class:"fas fa-comment"})],-1),e("div",{class:"label"},"SMS",-1)]),2),e("div",{class:g(["menu-item",{active:i.value==="email"}]),onClick:o[2]||(o[2]=n=>i.value="email")},o[12]||(o[12]=[e("div",{class:"icon"},[e("i",{class:"fas fa-envelope"})],-1),e("div",{class:"label"},"Email",-1)]),2),e("div",{class:g(["menu-item",{active:i.value==="notes"}]),onClick:o[3]||(o[3]=n=>{i.value="notes",l.value="all"})},o[13]||(o[13]=[e("div",{class:"icon"},[e("i",{class:"fas fa-sticky-note"})],-1),e("div",{class:"label"},"Notes",-1)]),2),e("div",{class:g(["menu-item",{active:i.value==="callLog"}]),onClick:o[4]||(o[4]=n=>{i.value="callLog",l.value="all"})},o[14]||(o[14]=[e("div",{class:"icon"},[e("i",{class:"fas fa-phone"})],-1),e("div",{class:"label"},"Call Log",-1)]),2),e("div",{class:g(["menu-item",{active:i.value==="webActivity"}]),onClick:o[5]||(o[5]=n=>{i.value="webActivity",l.value="all"})},o[15]||(o[15]=[e("div",{class:"icon"},[e("i",{class:"fas fa-globe"})],-1),e("div",{class:"label"},"WEB Activity",-1)]),2)]),e("div",Ce,[o[24]||(o[24]=e("h4",{class:"mb-3"},"Timeline",-1)),i.value==="email"||i.value==="sms"?(p(),v("div",Ee,[o[17]||(o[17]=e("label",{class:"me-2 fw-bold"},"Filter:",-1)),a(e("select",{"onUpdate:modelValue":o[6]||(o[6]=n=>l.value=n),class:"form-select w-auto d-inline-block"},o[16]||(o[16]=[e("option",{value:"all"},"All",-1),e("option",{value:"sent"},"Sent",-1),e("option",{value:"received"},"Received",-1)]),512),[[W,l.value]])])):f("",!0),(p(!0),v(R,null,P(N.value,n=>(p(),v("div",{key:n.id,class:"card mb-2"},[e("div",Re,[e("h5",Pe,c(n.title),1),e("p",De,[n.type==="email"&&n.direction==="received"?(p(),v("span",Ne," From: "+c(n.from),1)):n.type==="email"&&n.direction==="sent"?(p(),v("span",Ie," To: "+c(n.to),1)):n.type==="sms"&&n.direction==="received"?(p(),v("span",Fe," From: "+c(n.phone),1)):n.type==="sms"&&n.direction==="sent"?(p(),v("span",Be," To: "+c(n.phone),1)):f("",!0),o[18]||(o[18]=e("br",null,null,-1)),e("span",{innerHTML:n.description},null,8,He)]),e("p",qe,c(n.date)+" "+c(n.time),1),n.type==="email"&&n.direction==="received"?(p(),v("button",{key:0,class:"btn btn-sm btn-primary",onClick:$=>T(n)}," Reply ",8,ze)):f("",!0),n.type==="email"?(p(),v("button",{key:1,class:"btn btn-sm btn-info ms-2",onClick:$=>I(n)}," View ",8,Oe)):f("",!0)])]))),128)),y.value?(p(),v("div",je,[e("div",We,[e("div",_e,[e("div",Ze,[e("h5",Ge,c(u.value.title),1),e("button",{type:"button",class:"btn-close",onClick:o[7]||(o[7]=n=>y.value=!1)})]),e("div",Je,[e("p",null,[o[19]||(o[19]=e("strong",null,"From:",-1)),w(" "+c(u.value.from),1)]),u.value.to?(p(),v("p",Xe,[o[20]||(o[20]=e("strong",null,"To:",-1)),w(" "+c(u.value.to),1)])):f("",!0),e("p",null,[o[21]||(o[21]=e("strong",null,"Subject:",-1)),w(" "+c(u.value.description),1)]),o[23]||(o[23]=e("hr",null,null,-1)),e("div",{innerHTML:u.value.body_html||u.value.body_plain},null,8,Ye),u.value.attachments&&u.value.attachments.length?(p(),v("div",Ke,[o[22]||(o[22]=e("h6",null,"Attachments:",-1)),e("ul",null,[(p(!0),v(R,null,P(u.value.attachments,(n,$)=>(p(),v("li",{key:$},[e("a",{href:n,target:"_blank"},c(F(n)),9,Qe)]))),128))])])):f("",!0)]),e("div",he,[e("button",{type:"button",class:"btn btn-secondary",onClick:o[8]||(o[8]=n=>y.value=!1)},"Close"),u.value.type==="email"&&u.value.direction==="received"?(p(),v("button",{key:0,class:"btn btn-primary",onClick:o[9]||(o[9]=n=>{T(u.value),y.value=!1})}," Reply ")):f("",!0)])])])])):f("",!0)])]))}},tt=D(et,[["__scopeId","data-v-8b7f5729"]]),lt={class:"lead-management container mt-4"},st={class:"d-flex justify-content-between align-items-center mb-3"},ot={class:"badge bg-primary me-2"},nt={class:"badge bg-secondary me-2"},at={class:"badge bg-info"},it={class:"nav nav-tabs mb-3"},dt={class:"nav-item"},rt={class:"nav-item"},mt={class:"nav-item"},ft={__name:"UpdateLeadPage",setup(U){const i=k("timeline"),l={first_name:"John",stage:"Prospect",source:"Website",customTag:"VIP"};return(y,u)=>(p(),v("div",lt,[e("div",st,[e("div",null,[e("h2",null,c(l.first_name),1),e("span",ot,c(l.stage),1),e("span",nt,c(l.source),1),e("span",at,c(l.customTag),1)]),u[3]||(u[3]=e("div",null,[e("button",{class:"btn btn-danger me-2"},[e("i",{class:"fas fa-microphone"})]),e("button",{class:"btn btn-danger"},[e("i",{class:"fas fa-times"})])],-1))]),e("ul",it,[e("li",dt,[e("a",{class:g(["nav-link",{active:i.value==="timeline"}]),onClick:u[0]||(u[0]=t=>i.value="timeline")},"Timeline",2)]),e("li",rt,[e("a",{class:g(["nav-link",{active:i.value==="profile"}]),onClick:u[1]||(u[1]=t=>i.value="profile")},"Profile",2)]),e("li",mt,[e("a",{class:g(["nav-link",{active:i.value==="analytics"}]),onClick:u[2]||(u[2]=t=>i.value="analytics")},"Analytics",2)])]),i.value==="timeline"?(p(),V(tt,{key:0})):f("",!0),i.value==="profile"?(p(),V(Te,{key:1})):f("",!0),i.value==="analytics"?(p(),V(_,{key:2})):f("",!0)]))}};export{ft as default};
