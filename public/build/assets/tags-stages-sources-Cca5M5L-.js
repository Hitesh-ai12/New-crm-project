import{a as _}from"./axios-CdtiCRuU.js";import{S as B}from"./sweetalert2.all-DyJFIm0t.js";import{r as u,R as I,_ as L,l as v,j as l,F as T,Z as w,k as m,L as N,bo as F,$ as x,o as g,P as S}from"./main-BxCp_q14.js";import"./_commonjsHelpers-BosuxZz1.js";_.interceptors.request.use(n=>{const e=localStorage.getItem("auth_token");return e&&(n.headers.Authorization=`Bearer ${e}`),n});function P(){const n=u([]),e=u([]),c=u([]),s=u(!1),i=u(""),p=u(!1),a=u(""),r=u(null),d=u(!1),h=u(""),k=async()=>{try{const o=(await _.get("/api/items")).data;n.value=o.tags||[],e.value=o.stages||[],c.value=o.sources||[]}catch(t){console.error("Error fetching items:",t)}},M=(t,o=null)=>{i.value=t,o?(p.value=!0,a.value=o.name,r.value=o):(p.value=!1,a.value="",r.value=null),s.value=!0},y=()=>{s.value=!1},E=async()=>{if(a.value.trim()===""){alert(`Please enter a valid ${i.value}.`);return}try{if(p.value&&r.value){const o=(await _.put(`/api/items/${r.value.id}`,{name:a.value})).data.item;b(i.value,o),C(`${i.value} updated successfully!`)}else{const o=(await _.post("/api/items",{name:a.value,type:i.value})).data.item;D(i.value,o),C(`${i.value} added successfully!`)}y()}catch(t){console.error("Error saving item:",t),alert("There was an error saving your data.")}},b=(t,o)=>{t==="tag"?n.value=n.value.map(f=>f.id===o.id?o:f):t==="stage"?e.value=e.value.map(f=>f.id===o.id?o:f):t==="source"&&(c.value=c.value.map(f=>f.id===o.id?o:f))},D=(t,o)=>{t==="tag"?n.value.push(o):t==="stage"?e.value.push(o):t==="source"&&c.value.push(o)},V=t=>{B.fire({title:`Are you sure you want to delete this ${t.type}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, Delete",cancelButtonText:"No, Cancel"}).then(async o=>{o.isConfirmed&&await A(t)})},A=async t=>{try{await _.delete(`/api/items/${t.id}`),t.type==="tag"?n.value=n.value.filter(o=>o.id!==t.id):t.type==="stage"?e.value=e.value.filter(o=>o.id!==t.id):t.type==="source"&&(c.value=c.value.filter(o=>o.id!==t.id)),C("Item deleted successfully!")}catch(o){console.error("Error deleting item:",o),alert("There was an error deleting your data.")}},C=t=>{h.value=t,d.value=!0,setTimeout(()=>d.value=!1,3e3)};return I(()=>{k()}),{tags:n,stages:e,sources:c,showModal:s,modalType:i,modalEditMode:p,inputValue:a,openModal:M,closeModal:y,saveItem:E,showToast:d,toastMessage:h,confirmDelete:V}}const U={setup(){const{tags:n,stages:e,sources:c,showModal:s,modalType:i,modalEditMode:p,inputValue:a,openModal:r,closeModal:d,saveItem:h,showToast:k,toastMessage:M,confirmDelete:y}=P();return{tags:n,stages:e,sources:c,showModal:s,modalType:i,modalEditMode:p,inputValue:a,openModal:r,closeModal:d,saveItem:h,showToast:k,toastMessage:M,confirmDelete:y}}},j={class:"cards-container"},q={class:"card"},z={class:"tags"},R={class:"tag-icons"},Y=["onClick"],Z=["onClick"],G={class:"card"},H={class:"stages"},J={class:"tag-icons"},K=["onClick"],O=["onClick"],Q={class:"card"},W={class:"sources"},X={class:"tag-icons"},$=["onClick"],ee=["onClick"],se={key:0,class:"tss-modal-overlay"},oe={class:"tss-modal"},ae=["placeholder"],te={class:"tss-modal-actions"},le={key:1,class:"tss-toast"};function ne(n,e,c,s,i,p){return g(),v("div",null,[e[9]||(e[9]=l("h1",{class:"tss-class"},"Tags | Stage | Source",-1)),l("div",j,[l("div",q,[e[6]||(e[6]=l("h3",null,"Tags",-1)),l("div",z,[(g(!0),v(T,null,w(s.tags,(a,r)=>(g(),v("span",{key:a.id,class:"tag"},[l("div",R,[l("span",{class:"tag-icon",onClick:d=>s.openModal("tag",a)},"✏️",8,Y),l("span",{class:"delete-icon",onClick:d=>s.confirmDelete(a)},"🗑️",8,Z)]),S(" "+m(a.name),1)]))),128)),l("button",{onClick:e[0]||(e[0]=a=>s.openModal("tag"))},"➕ Add Tag")])]),l("div",G,[e[7]||(e[7]=l("h3",null,"Stage",-1)),l("div",H,[(g(!0),v(T,null,w(s.stages,(a,r)=>(g(),v("span",{key:r,class:"stage"},[l("div",J,[l("span",{class:"tag-icon",onClick:d=>s.openModal("stage",a)},"✏️",8,K),l("span",{class:"delete-icon",onClick:d=>s.confirmDelete(a)},"🗑️",8,O)]),S(" "+m(a.name),1)]))),128)),l("button",{onClick:e[1]||(e[1]=a=>s.openModal("stage"))},"➕ Add Stage")])]),l("div",Q,[e[8]||(e[8]=l("h3",null,"Source",-1)),l("div",W,[(g(!0),v(T,null,w(s.sources,(a,r)=>(g(),v("span",{key:r,class:"source"},[l("div",X,[l("span",{class:"tag-icon",onClick:d=>s.openModal("source",a)},"✏️",8,$),l("span",{class:"delete-icon",onClick:d=>s.confirmDelete(a)},"🗑️",8,ee)]),S(" "+m(a.name),1)]))),128)),l("button",{onClick:e[2]||(e[2]=a=>s.openModal("source"))},"➕ Add Source")])])]),s.showModal?(g(),v("div",se,[l("div",oe,[l("h3",null,m(s.modalEditMode?"Edit":"Add")+" "+m(s.modalType),1),N(l("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=a=>s.inputValue=a),placeholder:"Enter "+s.modalType},null,8,ae),[[F,s.inputValue]]),l("div",te,[l("button",{onClick:e[4]||(e[4]=(...a)=>s.saveItem&&s.saveItem(...a))},m(s.modalEditMode?"Update":"Add")+" "+m(s.modalType),1),l("button",{class:"tss-cancel",onClick:e[5]||(e[5]=(...a)=>s.closeModal&&s.closeModal(...a))},"Close")])])])):x("",!0),s.showToast?(g(),v("div",le,m(s.toastMessage),1)):x("",!0)])}const ue=L(U,[["render",ne],["__scopeId","data-v-bf97b43b"]]);export{ue as default};
