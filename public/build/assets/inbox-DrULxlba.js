import{a as P}from"./axios-CdtiCRuU.js";import{_ as ie,o as b,l as v,j as o,L as F,d6 as G,F as N,Y as U,n as j,k as w,X as R,dd as zs,r as k,w as et,P as tt,Z as st,aG as nt,au as ot,f as Je,p as Ps,e as Fs}from"./main-C7aftqr6.js";import"./bootstrap.min-KxrJAQL6.js";import{S as L}from"./sweetalert2.all-DyJFIm0t.js";import{t as _}from"./theme-BF0MZ1aw.js";import"./_commonjsHelpers-BosuxZz1.js";const js={data(){return{leads:[],selectedLead:null,messages:[],searchQuery:""}},computed:{filteredLeads(){return this.leads.filter(h=>`${h.firstName||""} ${h.lastName||""}`.trim().toLowerCase().includes(this.searchQuery.toLowerCase()))}},methods:{async fetchLeads(){const m={Authorization:`Bearer ${localStorage.getItem("auth_token")}`},S=await P.get("/api/email/chats",{headers:m});this.leads=S.data},async selectLead(h){const S={Authorization:`Bearer ${localStorage.getItem("auth_token")}`},C=await P.get(`/api/email/lead/${h.leadId}`,{headers:S});this.selectedLead=h,this.messages=C.data.reverse(),this.$nextTick(()=>this.scrollToBottom())},scrollToBottom(){const h=this.$refs.emailArea;h&&(h.scrollTop=h.scrollHeight)}},mounted(){this.fetchLeads()}},Os={class:"email-chat d-flex shadow rounded",style:{"block-size":"90vh"}},Vs={class:"border-end p-3",style:{"inline-size":"300px"}},Hs=["onClick"],Rs={class:"flex-grow-1 d-flex flex-column bg-light"},Gs={class:"border-bottom p-3 bg-white"},Qs={key:0},Ws={key:1,class:"text-muted"},qs={class:"flex-grow-1 overflow-auto p-3",ref:"emailArea"},Ks={key:0,class:"text-center text-muted small"},Ys={class:"mt-1"},Zs={class:"d-block text-end mt-1"};function Xs(h,m,S,C,d,p){return b(),v("div",Os,[o("div",Vs,[F(o("input",{class:"form-control mb-2","onUpdate:modelValue":m[0]||(m[0]=u=>d.searchQuery=u),placeholder:"Search lead"},null,512),[[G,d.searchQuery]]),(b(!0),v(N,null,U(p.filteredLeads,u=>{var i;return b(),v("div",{key:u.leadId,class:j(["lead-item p-2 border-bottom",{"bg-primary text-white":((i=d.selectedLead)==null?void 0:i.leadId)===u.leadId}]),onClick:f=>p.selectLead(u)},w(u.firstName)+" "+w(u.lastName),11,Hs)}),128))]),o("div",Rs,[o("div",Gs,[d.selectedLead?(b(),v("h5",Qs,w(d.selectedLead.firstName)+" "+w(d.selectedLead.lastName),1)):(b(),v("p",Ws,"Select a lead to view emails"))]),o("div",qs,[(b(!0),v(N,null,U(d.messages,(u,i)=>(b(),v("div",{key:i,class:"mb-3"},[u.date?(b(),v("div",Ks,w(u.date),1)):R("",!0),o("div",{class:j(["p-3 rounded shadow-sm",u.direction==="sent"?"bg-info text-white ms-auto":"bg-white me-auto"]),style:{"max-inline-size":"75%"}},[o("strong",null,w(u.subject),1),o("div",Ys,w(u.description),1),o("small",Zs,w(u.time),1)],2)]))),128))],512)])])}const Js=ie(js,[["render",Xs]]),en={data(){return{searchQuery:"",newMessage:"",selectedChat:null,leads:[],messages:[]}},computed:{filteredLeads(){return this.leads.filter(h=>h.name.toLowerCase().includes(this.searchQuery.toLowerCase()))}},methods:{async fetchLeads(){try{const m={Authorization:`Bearer ${localStorage.getItem("auth_token")}`},S=await P.get("/api/sms/leads",{headers:m});this.leads=S.data}catch(h){console.error("Error loading leads:",h)}},async selectChat(h){try{const S={Authorization:`Bearer ${localStorage.getItem("auth_token")}`},d=(await P.get(`/api/sms/lead/${h.leadId}`,{headers:S})).data,p=d.length>0?d[0].phone:h.phone||"";this.selectedChat={...h,phone:p},this.messages=d.reverse(),this.$nextTick(()=>this.scrollToBottom())}catch(m){console.error("Error loading messages:",m)}},async sendMessage(){const h=localStorage.getItem("auth_token"),m=parseInt(localStorage.getItem("user_id")),S={Authorization:`Bearer ${h}`};try{const C={lead_ids:[this.selectedChat.leadId],user_id:m,from:"+16187452168",to:this.selectedChat.phone,subject:"SMS Chat",message:this.newMessage};await P.post("/api/send-sms",C,{headers:S});const d=new Date,p=d.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),u=d.toISOString().slice(0,10);this.messages.push({id:`sms-sent-${Date.now()}`,type:"sms",direction:"sent",phone:this.selectedChat.phone,title:"Sent SMS",description:this.newMessage,leadId:this.selectedChat.leadId,date:u,time:p}),this.newMessage="",this.$nextTick(()=>this.scrollToBottom())}catch(C){console.error("Send SMS Error:",C),L.fire("Error","Failed to send SMS.","error")}},scrollToBottom(){const h=this.$refs.messagesArea;h&&(h.scrollTop=h.scrollHeight)}},mounted(){this.fetchLeads()}},tn={class:"chat-container d-flex shadow rounded",style:{"block-size":"90vh","margin-block":"20px","margin-inline":"auto","max-inline-size":"1200px"}},sn={class:"sidebar border-end d-flex flex-column bg-white",style:{"inline-size":"320px","min-inline-size":"250px"}},nn={class:"p-3 border-bottom"},on={class:"flex-grow-1 overflow-auto chat-list"},ln=["onClick"],an={class:"flex-grow-1"},rn={class:"fw-bold"},cn={class:"chat-window d-flex flex-column flex-grow-1 bg-light"},dn={key:0,class:"chat-header d-flex align-items-center p-3 border-bottom bg-white"},mn={class:"mb-0 flex-grow-1"},un={key:1,class:"chat-header d-flex align-items-center justify-content-center p-3 text-muted"},gn={class:"messages-area flex-grow-1 p-4 overflow-auto",ref:"messagesArea"},pn={key:0,class:"text-center small text-muted mb-2"},hn={class:"d-block text-end mt-1 text-white-50"},bn={key:2,class:"p-3 border-top bg-white"},fn={class:"input-group position-relative"};function vn(h,m,S,C,d,p){return b(),v("div",tn,[o("div",sn,[o("div",nn,[F(o("input",{type:"text",class:"form-control rounded-pill",placeholder:"Search lead","onUpdate:modelValue":m[0]||(m[0]=u=>d.searchQuery=u)},null,512),[[G,d.searchQuery]])]),o("div",on,[(b(!0),v(N,null,U(p.filteredLeads,u=>(b(),v("div",{key:u.leadId,onClick:i=>p.selectChat(u),class:j(["d-flex align-items-center p-3 border-bottom chat-item",{"bg-primary text-white":d.selectedChat&&d.selectedChat.leadId===u.leadId}]),style:{cursor:"pointer"}},[m[4]||(m[4]=o("img",{src:"https://cdn-icons-png.flaticon.com/512/1384/1384031.png",width:"45",height:"45",class:"rounded-circle me-3",alt:"Avatar"},null,-1)),o("div",an,[o("div",rn,w(u.name),1),o("small",{class:j(["text-muted",{"text-white-50":d.selectedChat&&d.selectedChat.leadId===u.leadId}])}," Lead ID: "+w(u.leadId),3)])],10,ln))),128))])]),o("div",cn,[d.selectedChat?(b(),v("div",dn,[m[5]||(m[5]=o("img",{src:"https://cdn-icons-png.flaticon.com/512/1384/1384031.png",width:"40",height:"40",class:"rounded-circle me-3",alt:"Avatar"},null,-1)),o("h5",mn,w(d.selectedChat.name),1)])):(b(),v("div",un," Select a lead to view messages ")),o("div",gn,[d.messages.length&&d.selectedChat?(b(!0),v(N,{key:0},U(d.messages,(u,i)=>(b(),v("div",{key:i,class:"mb-3"},[u.date?(b(),v("div",pn,[o("strong",null,w(u.date),1)])):R("",!0),o("div",{class:j(["message-bubble p-3 rounded shadow-sm",u.direction==="sent"?"bg-success text-white ms-auto":"bg-white me-auto"]),style:{"max-inline-size":"75%"}},[o("div",null,w(u.description),1),o("small",hn,w(u.time),1)],2)]))),128)):R("",!0)],512),d.selectedChat?(b(),v("div",bn,[o("div",fn,[F(o("input",{type:"text",class:"form-control rounded-pill pe-5",placeholder:"Type a message","onUpdate:modelValue":m[1]||(m[1]=u=>d.newMessage=u),onKeyup:m[2]||(m[2]=zs((...u)=>p.sendMessage&&p.sendMessage(...u),["enter"]))},null,544),[[G,d.newMessage]]),o("button",{class:"btn btn-primary rounded-circle position-absolute",style:{"z-index":"1","block-size":"40px","inline-size":"40px","inset-block-start":"50%","inset-inline-end":"10px",transform:"translateY(-50%)"},onClick:m[3]||(m[3]=(...u)=>p.sendMessage&&p.sendMessage(...u))},m[6]||(m[6]=[o("i",{class:"bi bi-send"},null,-1)]))])])):R("",!0)])])}const yn=ie(en,[["render",vn]]);(function(){var h=tinymce.util.Tools.resolve("tinymce.PluginManager");const m=(i,f)=>{i.focus(),i.undoManager.transact(()=>{i.setContent(f)}),i.selection.setCursorLocation(),i.nodeChanged()},S=i=>i.getContent({source_view:!0}),C=i=>{const f=S(i);i.windowManager.open({title:"Source Code",size:"large",body:{type:"panel",items:[{type:"textarea",name:"code"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{code:f},onSubmit:M=>{m(i,M.getData().code),M.close()}})},d=i=>{i.addCommand("mceCodeEditor",()=>{C(i)})},p=i=>{const f=()=>i.execCommand("mceCodeEditor");i.ui.registry.addButton("code",{icon:"sourcecode",tooltip:"Source code",onAction:f}),i.ui.registry.addMenuItem("code",{icon:"sourcecode",text:"Source code",onAction:f})};var u=()=>{h.add("code",i=>(d(i),p(i),{}))};u()})();(function(){var h=tinymce.util.Tools.resolve("tinymce.PluginManager");const m=Object.getPrototypeOf,S=(e,t,s)=>{var n;return s(e,t.prototype)?!0:((n=e.constructor)===null||n===void 0?void 0:n.name)===t.name},C=e=>{const t=typeof e;return e===null?"null":t==="object"&&Array.isArray(e)?"array":t==="object"&&S(e,String,(s,n)=>n.isPrototypeOf(s))?"string":t},d=e=>t=>C(t)===e,p=e=>t=>typeof t===e,u=e=>t=>e===t,i=(e,t)=>M(e)&&S(e,t,(s,n)=>m(s)===n),f=d("string"),M=d("object"),Q=e=>i(e,Object),W=d("array"),J=u(null),q=p("boolean"),ee=e=>e==null,E=e=>!ee(e),K=p("function"),te=p("number"),se=(e,t)=>{if(W(e)){for(let s=0,n=e.length;s<n;++s)if(!t(e[s]))return!1;return!0}return!1},ne=()=>{};class a{constructor(t,s){this.tag=t,this.value=s}static some(t){return new a(!0,t)}static none(){return a.singletonNone}fold(t,s){return this.tag?s(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?a.some(t(this.value)):a.none()}bind(t){return this.tag?t(this.value):a.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:a.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t??"Called getOrDie on None")}static from(t){return E(t)?a.some(t):a.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}a.singletonNone=new a(!1);const l=Array.prototype.push,c=e=>{const t=[];for(let s=0,n=e.length;s<n;++s){if(!W(e[s]))throw new Error("Arr.flatten item "+s+" was not an array, input: "+e);l.apply(t,e[s])}return t},x=(e,t)=>t>=0&&t<e.length?a.some(e[t]):a.none(),V=e=>x(e,0),B=(e,t)=>{for(let s=0;s<e.length;s++){const n=t(e[s],s);if(n.isSome())return n}return a.none()},lt=Object.keys,at=Object.hasOwnProperty,rt=(e,t)=>{const s=lt(e);for(let n=0,r=s.length;n<r;n++){const g=s[n],y=e[g];t(y,g)}},it=e=>(t,s)=>{e[s]=t},ct=(e,t,s,n)=>{rt(e,(r,g)=>{(t(r,g)?s:n)(r,g)})},dt=(e,t)=>{const s={};return ct(e,t,it(s),ne),s},ue=(e,t)=>at.call(e,t),mt=(e,t)=>ue(e,t)&&e[t]!==void 0&&e[t]!==null,ge=(e=>(...t)=>{if(t.length===0)throw new Error("Can't merge zero objects");const s={};for(let n=0;n<t.length;n++){const r=t[n];for(const g in r)ue(r,g)&&(s[g]=e(s[g],r[g]))}return s})((e,t)=>Q(e)&&Q(t)?ge(e,t):t),ye=e=>e.length>0,ut=(e,t)=>{const n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1){const r="HTML does not have a single root node";throw console.error(r,e),new Error(r)}return oe(n.childNodes[0])},gt=(e,t)=>{const n=(t||document).createElement(e);return oe(n)},pt=(e,t)=>{const n=(t||document).createTextNode(e);return oe(n)},oe=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},pe={fromHtml:ut,fromTag:gt,fromText:pt,fromDom:oe,fromPoint:(e,t,s)=>a.from(e.dom.elementFromPoint(t,s)).map(oe)},ht=(e,t,s)=>{if(f(s)||q(s)||te(s))e.setAttribute(t,s+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",s,":: Element ",e),new Error("Attribute value was not simple")},Se=(e,t,s)=>{ht(e.dom,t,s)},bt=(e,t)=>{e.dom.removeAttribute(t)};var ft=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),vt=tinymce.util.Tools.resolve("tinymce.util.URI");const A=e=>t=>t.options.get(e),yt=e=>{const t=e.options.register;t("image_dimensions",{processor:"boolean",default:!0}),t("image_advtab",{processor:"boolean",default:!1}),t("image_uploadtab",{processor:"boolean",default:!0}),t("image_prepend_url",{processor:"string",default:""}),t("image_class_list",{processor:"object[]"}),t("image_description",{processor:"boolean",default:!0}),t("image_title",{processor:"boolean",default:!1}),t("image_caption",{processor:"boolean",default:!1}),t("image_list",{processor:s=>{const n=s===!1||f(s)||se(s,M)||K(s);return n?{value:s,valid:n}:{valid:!1,message:"Must be false, a string, an array or a function."}},default:!1})},we=A("image_dimensions"),St=A("image_advtab"),wt=A("image_uploadtab"),Ct=A("image_prepend_url"),xt=A("image_class_list"),_t=A("image_description"),It=A("image_title"),kt=A("image_caption"),Tt=A("image_list"),Mt=A("a11y_advanced_options"),At=A("automatic_uploads"),Dt=e=>ye(e.options.get("images_upload_url")),$t=e=>E(e.options.get("images_upload_handler")),Ce=(e,t)=>Math.max(parseInt(e,10),parseInt(t,10)),Lt=e=>new Promise(t=>{const s=document.createElement("img"),n=g=>{s.parentNode&&s.parentNode.removeChild(s),t(g)};s.addEventListener("load",()=>{const g=Ce(s.width,s.clientWidth),y=Ce(s.height,s.clientHeight),I={width:g,height:y};n(Promise.resolve(I))}),s.addEventListener("error",()=>{n(Promise.reject(`Failed to get image dimensions for: ${e}`))});const r=s.style;r.visibility="hidden",r.position="fixed",r.bottom=r.left="0px",r.width=r.height="auto",document.body.appendChild(s),s.src=e}),ce=e=>(e&&(e=e.replace(/px$/,"")),e),de=e=>(e.length>0&&/^[0-9]+$/.test(e)&&(e+="px"),e),Et=e=>{if(e.margin){const t=String(e.margin).split(" ");switch(t.length){case 1:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[0],e["margin-bottom"]=e["margin-bottom"]||t[0],e["margin-left"]=e["margin-left"]||t[0];break;case 2:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[0],e["margin-left"]=e["margin-left"]||t[1];break;case 3:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[2],e["margin-left"]=e["margin-left"]||t[1];break;case 4:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[2],e["margin-left"]=e["margin-left"]||t[3]}delete e.margin}return e},Nt=(e,t)=>{const s=Tt(e);f(s)?fetch(s).then(n=>{n.ok&&n.json().then(t)}):K(s)?s(t):t(s)},Ut=(e,t,s)=>{const n=()=>{s.onload=s.onerror=null,e.selection&&(e.selection.select(s),e.nodeChanged())};s.onload=()=>{!t.width&&!t.height&&we(e)&&e.dom.setAttribs(s,{width:String(s.clientWidth),height:String(s.clientHeight)}),n()},s.onerror=n},Bt=e=>new Promise((t,s)=>{const n=new FileReader;n.onload=()=>{t(n.result)},n.onerror=()=>{var r;s((r=n.error)===null||r===void 0?void 0:r.message)},n.readAsDataURL(e)}),xe=e=>e.nodeName==="IMG"&&(e.hasAttribute("data-mce-object")||e.hasAttribute("data-mce-placeholder")),_e=(e,t)=>{const s=e.options.get;return vt.isDomSafe(t,"img",{allow_html_data_urls:s("allow_html_data_urls"),allow_script_urls:s("allow_script_urls"),allow_svg_data_urls:s("allow_svg_data_urls")})},T=ft.DOM,Ie=e=>e.style.marginLeft&&e.style.marginRight&&e.style.marginLeft===e.style.marginRight?ce(e.style.marginLeft):"",ke=e=>e.style.marginTop&&e.style.marginBottom&&e.style.marginTop===e.style.marginBottom?ce(e.style.marginTop):"",Te=e=>e.style.borderWidth?ce(e.style.borderWidth):"",Y=(e,t)=>{var s;return e.hasAttribute(t)&&(s=e.getAttribute(t))!==null&&s!==void 0?s:""},Me=e=>e.parentNode!==null&&e.parentNode.nodeName==="FIGURE",Z=(e,t,s)=>{s===""||s===null?e.removeAttribute(t):e.setAttribute(t,s)},zt=e=>{const t=T.create("figure",{class:"image"});T.insertAfter(t,e),t.appendChild(e),t.appendChild(T.create("figcaption",{contentEditable:"true"},"Caption")),t.contentEditable="false"},Pt=e=>{const t=e.parentNode;E(t)&&(T.insertAfter(e,t),T.remove(t))},Ft=e=>{Me(e)?Pt(e):zt(e)},Ae=(e,t)=>{const s=e.getAttribute("style"),n=t(s!==null?s:"");n.length>0?(e.setAttribute("style",n),e.setAttribute("data-mce-style",n)):e.removeAttribute("style")},De=(e,t)=>(s,n,r)=>{const g=s.style;g[n]?(g[n]=de(r),Ae(s,t)):Z(s,n,r)},$e=(e,t)=>e.style[t]?ce(e.style[t]):Y(e,t),Le=(e,t)=>{const s=de(t);e.style.marginLeft=s,e.style.marginRight=s},Ee=(e,t)=>{const s=de(t);e.style.marginTop=s,e.style.marginBottom=s},Ne=(e,t)=>{const s=de(t);e.style.borderWidth=s},Ue=(e,t)=>{e.style.borderStyle=t},Be=e=>{var t;return(t=e.style.borderStyle)!==null&&t!==void 0?t:""},he=e=>E(e)&&e.nodeName==="FIGURE",jt=e=>e.nodeName==="IMG",ze=e=>T.getAttrib(e,"alt").length===0&&T.getAttrib(e,"role")==="presentation",Ot=e=>ze(e)?"":Y(e,"alt"),Pe=()=>({src:"",alt:"",title:"",width:"",height:"",class:"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:"",isDecorative:!1}),Vt=(e,t)=>{var s;const n=document.createElement("img");return Z(n,"style",t.style),(Ie(n)||t.hspace!=="")&&Le(n,t.hspace),(ke(n)||t.vspace!=="")&&Ee(n,t.vspace),(Te(n)||t.border!=="")&&Ne(n,t.border),(Be(n)||t.borderStyle!=="")&&Ue(n,t.borderStyle),e((s=n.getAttribute("style"))!==null&&s!==void 0?s:"")},Ht=(e,t)=>{const s=document.createElement("img");if(je(e,{...t,caption:!1},s),Fe(s,t.alt,t.isDecorative),t.caption){const n=T.create("figure",{class:"image"});return n.appendChild(s),n.appendChild(T.create("figcaption",{contentEditable:"true"},"Caption")),n.contentEditable="false",n}else return s},be=(e,t)=>({src:Y(t,"src"),alt:Ot(t),title:Y(t,"title"),width:$e(t,"width"),height:$e(t,"height"),class:Y(t,"class"),style:e(Y(t,"style")),caption:Me(t),hspace:Ie(t),vspace:ke(t),border:Te(t),borderStyle:Be(t),isDecorative:ze(t)}),D=(e,t,s,n,r)=>{s[n]!==t[n]&&r(e,n,String(s[n]))},Fe=(e,t,s)=>{if(s){T.setAttrib(e,"role","presentation");const n=pe.fromDom(e);Se(n,"alt","")}else{if(J(t)){const n=pe.fromDom(e);bt(n,"alt")}else{const n=pe.fromDom(e);Se(n,"alt",t)}T.getAttrib(e,"role")==="presentation"&&T.setAttrib(e,"role","")}},Rt=(e,t,s)=>{(s.alt!==t.alt||s.isDecorative!==t.isDecorative)&&Fe(e,s.alt,s.isDecorative)},le=(e,t)=>(s,n,r)=>{e(s,r),Ae(s,t)},je=(e,t,s)=>{const n=be(e,s);D(s,n,t,"caption",(r,g,y)=>Ft(r)),D(s,n,t,"src",Z),D(s,n,t,"title",Z),D(s,n,t,"width",De("width",e)),D(s,n,t,"height",De("height",e)),D(s,n,t,"class",Z),D(s,n,t,"style",le((r,g)=>Z(r,"style",g),e)),D(s,n,t,"hspace",le(Le,e)),D(s,n,t,"vspace",le(Ee,e)),D(s,n,t,"border",le(Ne,e)),D(s,n,t,"borderStyle",le(Ue,e)),Rt(s,n,t)},ae=(e,t)=>{const s=e.dom.styles.parse(t),n=Et(s),r=e.dom.styles.parse(e.dom.styles.serialize(n));return e.dom.styles.serialize(r)},me=e=>{const t=e.selection.getNode(),s=e.dom.getParent(t,"figure.image");return s?e.dom.select("img",s)[0]:t&&(t.nodeName!=="IMG"||xe(t))?null:t},Oe=(e,t)=>{var s;const n=e.dom,r=dt(e.schema.getTextBlockElements(),(y,I)=>!e.schema.isValidChild(I,"figure")),g=n.getParent(t.parentNode,y=>mt(r,y.nodeName),e.getBody());return g&&(s=n.split(g,t))!==null&&s!==void 0?s:t},Gt=e=>{const t=me(e);return t?be(s=>ae(e,s),t):Pe()},Qt=(e,t)=>{const s=Ht(r=>ae(e,r),t);e.dom.setAttrib(s,"data-mce-id","__mcenew"),e.focus(),e.selection.setContent(s.outerHTML);const n=e.dom.select('*[data-mce-id="__mcenew"]')[0];if(e.dom.setAttrib(n,"data-mce-id",null),he(n)){const r=Oe(e,n);e.selection.select(r)}else e.selection.select(n)},Wt=(e,t)=>{e.dom.setAttrib(t,"src",t.getAttribute("src"))},qt=(e,t)=>{if(t){const s=e.dom.is(t.parentNode,"figure.image")?t.parentNode:t;e.dom.remove(s),e.focus(),e.nodeChanged(),e.dom.isEmpty(e.getBody())&&(e.setContent(""),e.selection.setCursorLocation())}},Kt=(e,t)=>{const s=me(e);if(s)if(je(n=>ae(e,n),t,s),Wt(e,s),he(s.parentNode)){e.dom.setStyle(s,"float","");const n=s.parentNode;Oe(e,n),e.selection.select(s.parentNode)}else e.selection.select(s),Ut(e,t,s)},Yt=(e,t)=>{const s=t.src;return{...t,src:_e(e,s)?s:""}},Zt=(e,t)=>{const s=me(e);if(s){const r={...be(y=>ae(e,y),s),...t},g=Yt(e,r);r.src?Kt(e,g):qt(e,s)}else t.src&&Qt(e,{...Pe(),...t})};var Xt=tinymce.util.Tools.resolve("tinymce.util.ImageUploader"),Ve=tinymce.util.Tools.resolve("tinymce.util.Tools");const He=e=>f(e.value)?e.value:"",Jt=e=>f(e.text)?e.text:f(e.title)?e.title:"",Re=(e,t)=>{const s=[];return Ve.each(e,n=>{const r=Jt(n);if(n.menu!==void 0){const g=Re(n.menu,t);s.push({text:r,items:g})}else{const g=t(n);s.push({text:r,value:g})}}),s},Ge=(e=He)=>t=>t?a.from(t).map(s=>Re(s,e)):a.none(),es=e=>Ge(He)(e),ts=e=>ue(e,"items"),Qe=(e,t)=>B(e,s=>ts(s)?Qe(s.items,t):s.value===t?a.some(s):a.none()),X={sanitizer:Ge,sanitize:es,findEntry:(e,t)=>e.bind(s=>Qe(s,t))},ss={makeTab:e=>({title:"Advanced",name:"advanced",items:[{type:"grid",columns:2,items:[{type:"input",label:"Vertical space",name:"vspace",inputMode:"numeric"},{type:"input",label:"Horizontal space",name:"hspace",inputMode:"numeric"},{type:"input",label:"Border width",name:"border",inputMode:"numeric"},{type:"listbox",name:"borderstyle",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]}]}]})},ns=e=>{const t=X.sanitizer(z=>e.convertURL(z.value||z.url||"","src")),s=new Promise(z=>{Nt(e,Us=>{z(t(Us).map(Bs=>c([[{text:"None",value:""}],Bs])))})}),n=X.sanitize(xt(e)),r=St(e),g=wt(e),y=Dt(e),I=$t(e),O=Gt(e),H=_t(e),$=It(e),re=we(e),$s=kt(e),Ls=Mt(e),Es=At(e),Ns=a.some(Ct(e)).filter(z=>f(z)&&z.length>0);return s.then(z=>({image:O,imageList:z,classList:n,hasAdvTab:r,hasUploadTab:g,hasUploadUrl:y,hasUploadHandler:I,hasDescription:H,hasImageTitle:$,hasDimensions:re,hasImageCaption:$s,prependURL:Ns,hasAccessibilityOptions:Ls,automaticUploads:Es}))},We=e=>{const t={name:"src",type:"urlinput",filetype:"image",label:"Source",picker_text:"Browse files"},s=e.imageList.map($=>({name:"images",type:"listbox",label:"Image list",items:$})),n={name:"alt",type:"input",label:"Alternative description",enabled:!(e.hasAccessibilityOptions&&e.image.isDecorative)},r={name:"title",type:"input",label:"Image title"},g={name:"dimensions",type:"sizeinput"},y={type:"label",label:"Accessibility",items:[{name:"isDecorative",type:"checkbox",label:"Image is decorative"}]},I=e.classList.map($=>({name:"classes",type:"listbox",label:"Class",items:$})),O={type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]},H=$=>$?{type:"grid",columns:2}:{type:"panel"};return c([[t],s.toArray(),e.hasAccessibilityOptions&&e.hasDescription?[y]:[],e.hasDescription?[n]:[],e.hasImageTitle?[r]:[],e.hasDimensions?[g]:[],[{...H(e.classList.isSome()&&e.hasImageCaption),items:c([I.toArray(),e.hasImageCaption?[O]:[]])}]])},qe={makeTab:e=>({title:"General",name:"general",items:We(e)}),makeItems:We},os={makeTab:e=>({title:"Upload",name:"upload",items:[{type:"dropzone",name:"fileinput"}]})},ls=e=>({prevImage:X.findEntry(e.imageList,e.image.src),prevAlt:e.image.alt,open:!0}),Ke=e=>({src:{value:e.src,meta:{}},images:e.src,alt:e.alt,title:e.title,dimensions:{width:e.width,height:e.height},classes:e.class,caption:e.caption,style:e.style,vspace:e.vspace,border:e.border,hspace:e.hspace,borderstyle:e.borderStyle,fileinput:[],isDecorative:e.isDecorative}),Ye=(e,t)=>({src:e.src.value,alt:(e.alt===null||e.alt.length===0)&&t?null:e.alt,title:e.title,width:e.dimensions.width,height:e.dimensions.height,class:e.classes,style:e.style,caption:e.caption,hspace:e.hspace,vspace:e.vspace,border:e.border,borderStyle:e.borderstyle,isDecorative:e.isDecorative}),as=(e,t)=>/^(?:[a-zA-Z]+:)?\/\//.test(t)?a.none():e.prependURL.bind(s=>t.substring(0,s.length)!==s?a.some(s+t):a.none()),rs=(e,t)=>{const s=t.getData();as(e,s.src.value).each(n=>{t.setData({src:{value:n,meta:s.src.meta}})})},is=(e,t,s)=>{e.hasDescription&&f(s.alt)&&(t.alt=s.alt),e.hasAccessibilityOptions&&(t.isDecorative=s.isDecorative||t.isDecorative||!1),e.hasImageTitle&&f(s.title)&&(t.title=s.title),e.hasDimensions&&(f(s.width)&&(t.dimensions.width=s.width),f(s.height)&&(t.dimensions.height=s.height)),f(s.class)&&X.findEntry(e.classList,s.class).each(n=>{t.classes=n.value}),e.hasImageCaption&&q(s.caption)&&(t.caption=s.caption),e.hasAdvTab&&(f(s.style)&&(t.style=s.style),f(s.vspace)&&(t.vspace=s.vspace),f(s.border)&&(t.border=s.border),f(s.hspace)&&(t.hspace=s.hspace),f(s.borderstyle)&&(t.borderstyle=s.borderstyle))},cs=(e,t)=>{const s=t.getData(),n=s.src.meta;if(n!==void 0){const r=ge({},s);is(e,r,n),t.setData(r)}},ds=(e,t,s,n)=>{const r=n.getData(),g=r.src.value,y=r.src.meta||{};!y.width&&!y.height&&t.hasDimensions&&(ye(g)?e.imageSize(g).then(I=>{s.open&&n.setData({dimensions:I})}).catch(I=>console.error(I)):n.setData({dimensions:{width:"",height:""}}))},ms=(e,t,s)=>{const n=s.getData(),r=X.findEntry(e.imageList,n.src.value);t.prevImage=r,s.setData({images:r.map(g=>g.value).getOr("")})},fe=(e,t,s,n)=>{rs(t,n),cs(t,n),ds(e,t,s,n),ms(t,s,n)},us=(e,t,s,n)=>{const r=n.getData(),g=X.findEntry(t.imageList,r.images);g.each(y=>{r.alt===""||s.prevImage.map(O=>O.text===r.alt).getOr(!1)?y.value===""?n.setData({src:y,alt:s.prevAlt}):n.setData({src:y,alt:y.text}):n.setData({src:y})}),s.prevImage=g,fe(e,t,s,n)},gs=(e,t,s,n)=>{const r=n.getData();n.block("Uploading image"),V(r.fileinput).fold(()=>{n.unblock()},g=>{const y=URL.createObjectURL(g),I=()=>{n.unblock(),URL.revokeObjectURL(y)},O=H=>{n.setData({src:{value:H,meta:{}}}),n.showTab("general"),fe(e,t,s,n),n.focus("src")};Bt(g).then(H=>{const $=e.createBlobCache(g,y,H);t.automaticUploads?e.uploadImage($).then(re=>{O(re.url),I()}).catch(re=>{I(),e.alertErr(re,()=>{n.focus("fileinput")})}):(e.addToBlobCache($),O($.blobUri()),n.unblock())})})},ps=(e,t,s)=>(n,r)=>{r.name==="src"?fe(e,t,s,n):r.name==="images"?us(e,t,s,n):r.name==="alt"?s.prevAlt=n.getData().alt:r.name==="fileinput"?gs(e,t,s,n):r.name==="isDecorative"&&n.setEnabled("alt",!n.getData().isDecorative)},hs=e=>()=>{e.open=!1},bs=e=>e.hasAdvTab||e.hasUploadUrl||e.hasUploadHandler?{type:"tabpanel",tabs:c([[qe.makeTab(e)],e.hasAdvTab?[ss.makeTab(e)]:[],e.hasUploadTab&&(e.hasUploadUrl||e.hasUploadHandler)?[os.makeTab(e)]:[]])}:{type:"panel",items:qe.makeItems(e)},fs=(e,t,s)=>n=>{const r=ge(Ke(t.image),n.getData()),g={...r,style:Vt(s.normalizeCss,Ye(r,!1))};e.execCommand("mceUpdateImage",!1,Ye(g,t.hasAccessibilityOptions)),e.editorUpload.uploadImagesAuto(),n.close()},vs=e=>t=>_e(e,t)?Lt(e.documentBaseURI.toAbsolute(t)).then(s=>({width:String(s.width),height:String(s.height)})):Promise.resolve({width:"",height:""}),ys=e=>(t,s,n)=>{var r;return e.editorUpload.blobCache.create({blob:t,blobUri:s,name:(r=t.name)===null||r===void 0?void 0:r.replace(/\.[^\.]+$/,""),filename:t.name,base64:n.split(",")[1]})},Ss=e=>t=>{e.editorUpload.blobCache.add(t)},ws=e=>(t,s)=>{e.windowManager.alert(t,s)},Cs=e=>t=>ae(e,t),xs=e=>t=>e.dom.parseStyle(t),_s=e=>(t,s)=>e.dom.serializeStyle(t,s),Is=e=>t=>Xt(e).upload([t],!1).then(s=>{var n;return s.length===0?Promise.reject("Failed to upload image"):s[0].status===!1?Promise.reject((n=s[0].error)===null||n===void 0?void 0:n.message):s[0]}),ve=e=>{const t={imageSize:vs(e),addToBlobCache:Ss(e),createBlobCache:ys(e),alertErr:ws(e),normalizeCss:Cs(e),parseStyle:xs(e),serializeStyle:_s(e),uploadImage:Is(e)};return{open:()=>{ns(e).then(n=>{const r=ls(n);return{title:"Insert/Edit Image",size:"normal",body:bs(n),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:Ke(n.image),onSubmit:fs(e,n,t),onChange:ps(t,n,r),onClose:hs(r)}}).then(e.windowManager.open)}}},ks=e=>{e.addCommand("mceImage",ve(e).open),e.addCommand("mceUpdateImage",(t,s)=>{e.undoManager.transact(()=>Zt(e,s))})},Ts=e=>{const t=e.attr("class");return E(t)&&/\bimage\b/.test(t)},Ze=e=>t=>{let s=t.length;const n=r=>{r.attr("contenteditable",e?"true":null)};for(;s--;){const r=t[s];Ts(r)&&(r.attr("contenteditable",e?"false":null),Ve.each(r.getAll("figcaption"),n))}},Ms=e=>{e.on("PreInit",()=>{e.parser.addNodeFilter("figure",Ze(!0)),e.serializer.addNodeFilter("figure",Ze(!1))})},Xe=e=>t=>{const s=()=>{t.setEnabled(e.selection.isEditable())};return e.on("NodeChange",s),s(),()=>{e.off("NodeChange",s)}},As=e=>{e.ui.registry.addToggleButton("image",{icon:"image",tooltip:"Insert/edit image",onAction:ve(e).open,onSetup:t=>{t.setActive(E(me(e)));const s=e.selection.selectorChangedWithUnbind("img:not([data-mce-object]):not([data-mce-placeholder]),figure.image",t.setActive).unbind,n=Xe(e)(t);return()=>{s(),n()}}}),e.ui.registry.addMenuItem("image",{icon:"image",text:"Image...",onAction:ve(e).open,onSetup:Xe(e)}),e.ui.registry.addContextMenu("image",{update:t=>e.selection.isEditable()&&(he(t)||jt(t)&&!xe(t))?["image"]:[]})};var Ds=()=>{h.add("image",e=>{yt(e),Ms(e),As(e),ks(e)})};Ds()})();const Sn={class:"modal-content"},wn={class:"modal-header"},Cn={class:"d-flex align-items-center gap-2"},xn={class:"modal-body"},_n={class:"mb-3"},In={class:"mb-3"},kn={class:"d-flex flex-wrap align-items-center gap-2"},Tn=["onClick"],Mn={class:"mb-3"},An=["value"],Dn={class:"mb-3"},$n=["value"],Ln={class:"mb-4"},En={__name:"EmailModal",props:{show:{type:Boolean,required:!0}},emits:["close"],setup(h,{emit:m}){const S=h,C=m,d=k(!1);k(!1);const p=k([]),u=k(["{{first_name}}","{{last_name}}"]),i=k({from:"",to:"",toName:"",subject:"",message:"",template:"",schedule:""}),f=k([]),M=k(!1);et(()=>S.show,async a=>{a?(await ot(),E(),te()):K()});const Q=()=>{i.value.to=p.value.map(a=>a.phone).join(", "),i.value.toName=p.value.map(a=>a.first_name).join(", ")},W=a=>{const l=a.target.value;l&&_.get("sms-editor")&&(_.get("sms-editor").execCommand("mceInsertContent",!1,` ${l} `),a.target.value="")},J=()=>{const a=f.value.find(l=>l.id===i.value.template);if(a){i.value.message=a.content;const l=_.get("sms-editor");l&&l.setContent(a.content)}},q=a=>{p.value.splice(a,1),Q()},ee=()=>{d.value=!d.value},E=()=>{_.get("sms-editor")||_.init({selector:"#sms-editor",height:300,license_key:"gpl",menubar:!1,plugins:"link lists image code",toolbar:"undo redo | bold italic | alignleft aligncenter alignright | bullist numlist | link code | mergeFieldButton",setup:a=>{a.on("Change",()=>{i.value.message=a.getContent()}),a.ui.registry.addMenuButton("mergeFieldButton",{text:"Merge Fields",fetch:l=>{const c=u.value.map(x=>({type:"menuitem",text:x,onAction:()=>a.insertContent(x)}));l(c)}})}})},K=()=>{const a=_.get("sms-editor");a&&a.remove()},te=async()=>{M.value=!0;try{const a=await P.get("/api/sms-templates");f.value=a.data.templates||[]}catch{L.fire("Error","Could not load SMS templates.","error")}finally{M.value=!1}},se=async()=>{const a=parseInt(localStorage.getItem("user_id")),l=_.get("sms-editor"),c=(l==null?void 0:l.getContent({format:"text"}))||i.value.message;if(!a||!i.value.from||p.value.length===0||!c.trim()){L.fire("Missing Info","Sender, recipient, and message are required.","error");return}try{const x=p.value.map(B=>B.phone),V=p.value.map(B=>B.id);await P.post("/api/send-sms",{user_id:a,from:i.value.from,to:x.join(", "),lead_ids:V,subject:i.value.subject,message:c,schedule:i.value.schedule||null}),L.fire("Success","SMS sent successfully.","success"),C("close")}catch{L.fire("Error","Failed to send SMS.","error")}},ne=()=>{var l;const a=((l=_.get("sms-editor"))==null?void 0:l.getContent({format:"text"}))||i.value.message;L.fire({title:"SMS Preview",html:`
      <strong>From:</strong> ${i.value.from}<br>
      <strong>To:</strong> ${i.value.to}<br>
      <strong>Message:</strong><br>${a}
    `,icon:"info"})};return(a,l)=>h.show?(b(),v("div",{key:0,class:"modal fade show d-block",tabindex:"-1",role:"dialog",onClick:l[6]||(l[6]=nt((...c)=>a.close&&a.close(...c),["self"]))},[o("div",{class:j(["modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",{"modal-fullscreen":d.value}])},[o("div",Sn,[o("div",wn,[l[7]||(l[7]=o("h5",{class:"modal-title"},"Compose SMS",-1)),o("div",Cn,[o("i",{class:"fas fa-expand-alt text-primary cursor-pointer",onClick:ee,title:"Expand"}),o("button",{type:"button",class:"btn-close",onClick:l[0]||(l[0]=(...c)=>a.close&&a.close(...c)),"aria-label":"Close"})])]),o("div",xn,[o("div",_n,[l[8]||(l[8]=o("label",{class:"form-label",for:"sms-from"},"From:",-1)),F(o("input",{type:"text",id:"sms-from",class:"form-control","onUpdate:modelValue":l[1]||(l[1]=c=>i.value.from=c),placeholder:"Sender name or phone"},null,512),[[G,i.value.from]])]),o("div",In,[l[9]||(l[9]=o("label",{class:"form-label"},"To:",-1)),o("div",kn,[(b(!0),v(N,null,U(p.value,(c,x)=>(b(),v("span",{key:c.id,class:"badge bg-success"},[tt(w(c.first_name)+" ",1),o("button",{type:"button",class:"btn-close btn-close-white btn-sm ms-2",onClick:V=>q(x)},null,8,Tn)]))),128)),o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:l[2]||(l[2]=(...c)=>a.openSmsLeadModal&&a.openSmsLeadModal(...c))},"+")])]),o("div",Mn,[l[11]||(l[11]=o("label",{class:"form-label"},"Template:",-1)),F(o("select",{class:"form-select","onUpdate:modelValue":l[3]||(l[3]=c=>i.value.template=c),onChange:J},[l[10]||(l[10]=o("option",{value:"",disabled:""},"Select a Template",-1)),(b(!0),v(N,null,U(f.value,c=>(b(),v("option",{key:c.id,value:c.id},w(c.name),9,An))),128))],544),[[st,i.value.template]])]),o("div",Dn,[l[13]||(l[13]=o("label",{class:"form-label"},"Merge Field:",-1)),o("select",{class:"form-select",onChange:l[4]||(l[4]=c=>W(c))},[l[12]||(l[12]=o("option",{value:""},"Select Tag",-1)),(b(!0),v(N,null,U(u.value,c=>(b(),v("option",{key:c,value:c},w(c),9,$n))),128))],32)]),l[15]||(l[15]=o("div",{class:"mb-3"},[o("label",{class:"form-label"},"Message:"),o("textarea",{id:"sms-editor"})],-1)),o("div",Ln,[l[14]||(l[14]=o("label",{class:"form-label"},"Schedule SMS:",-1)),F(o("input",{type:"datetime-local",class:"form-control","onUpdate:modelValue":l[5]||(l[5]=c=>i.value.schedule=c)},null,512),[[G,i.value.schedule]])]),o("div",{class:"d-flex justify-content-end gap-2"},[o("button",{class:"btn btn-info",onClick:ne},"Preview"),o("button",{class:"btn btn-success",onClick:se},"Send SMS")])])])],2)])):R("",!0)}},Nn=ie(En,[["__scopeId","data-v-782281ec"]]),Un={class:"modal-content"},Bn={class:"modal-header"},zn={class:"d-flex align-items-center gap-2"},Pn={class:"modal-body"},Fn={class:"mb-3"},jn={class:"mb-3"},On={class:"d-flex flex-wrap align-items-center gap-2"},Vn=["onClick"],Hn={class:"mb-3"},Rn=["value"],Gn={class:"mb-3"},Qn=["value"],Wn={class:"mb-4"},qn={__name:"SmsModal",props:{show:{type:Boolean,required:!0}},emits:["close"],setup(h,{emit:m}){const S=h,C=m,d=k(!1);k(!1);const p=k([]),u=k(["{{first_name}}","{{last_name}}"]),i=k({from:"",to:"",toName:"",subject:"",message:"",template:"",schedule:""}),f=k([]),M=k(!1);et(()=>S.show,async a=>{a?(await ot(),E(),te()):K()});const Q=()=>{i.value.to=p.value.map(a=>a.phone).join(", "),i.value.toName=p.value.map(a=>a.first_name).join(", ")},W=a=>{const l=a.target.value;l&&_.get("sms-editor")&&(_.get("sms-editor").execCommand("mceInsertContent",!1,` ${l} `),a.target.value="")},J=()=>{const a=f.value.find(l=>l.id===i.value.template);if(a){i.value.message=a.content;const l=_.get("sms-editor");l&&l.setContent(a.content)}},q=a=>{p.value.splice(a,1),Q()},ee=()=>{d.value=!d.value},E=()=>{_.get("sms-editor")||_.init({selector:"#sms-editor",height:300,license_key:"gpl",menubar:"file edit view insert format tools table help",plugins:"link lists image code",toolbar:"undo redo | bold italic | alignleft aligncenter alignright | bullist numlist | link code | mergeFieldButton",setup:a=>{a.on("Change",()=>{i.value.message=a.getContent()}),a.ui.registry.addMenuButton("mergeFieldButton",{text:"Merge Fields",fetch:l=>{const c=u.value.map(x=>({type:"menuitem",text:x,onAction:()=>a.insertContent(x)}));l(c)}})}})},K=()=>{const a=_.get("sms-editor");a&&a.remove()},te=async()=>{M.value=!0;try{const a=await P.get("/api/sms-templates");f.value=a.data.templates||[]}catch{L.fire("Error","Could not load SMS templates.","error")}finally{M.value=!1}},se=async()=>{const a=parseInt(localStorage.getItem("user_id")),l=_.get("sms-editor"),c=(l==null?void 0:l.getContent({format:"text"}))||i.value.message;if(!a||!i.value.from||p.value.length===0||!c.trim()){L.fire("Missing Info","Sender, recipient, and message are required.","error");return}try{const x=p.value.map(B=>B.phone),V=p.value.map(B=>B.id);await P.post("/api/send-sms",{user_id:a,from:i.value.from,to:x.join(", "),lead_ids:V,subject:i.value.subject,message:c,schedule:i.value.schedule||null}),L.fire("Success","SMS sent successfully.","success"),C("close")}catch{L.fire("Error","Failed to send SMS.","error")}},ne=()=>{var l;const a=((l=_.get("sms-editor"))==null?void 0:l.getContent({format:"text"}))||i.value.message;L.fire({title:"SMS Preview",html:`
      <strong>From:</strong> ${i.value.from}<br>
      <strong>To:</strong> ${i.value.to}<br>
      <strong>Message:</strong><br>${a}
    `,icon:"info"})};return(a,l)=>h.show?(b(),v("div",{key:0,class:"modal fade show d-block",tabindex:"-1",role:"dialog",onClick:l[6]||(l[6]=nt((...c)=>a.close&&a.close(...c),["self"]))},[o("div",{class:j(["modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",{"modal-fullscreen":d.value}])},[o("div",Un,[o("div",Bn,[l[7]||(l[7]=o("h5",{class:"modal-title"},"Compose SMS",-1)),o("div",zn,[o("i",{class:"fas fa-expand-alt text-primary cursor-pointer",onClick:ee,title:"Expand"}),o("button",{type:"button",class:"btn-close",onClick:l[0]||(l[0]=(...c)=>a.close&&a.close(...c)),"aria-label":"Close"})])]),o("div",Pn,[o("div",Fn,[l[8]||(l[8]=o("label",{class:"form-label",for:"sms-from"},"From:",-1)),F(o("input",{type:"text",id:"sms-from",class:"form-control","onUpdate:modelValue":l[1]||(l[1]=c=>i.value.from=c),placeholder:"Sender name or phone"},null,512),[[G,i.value.from]])]),o("div",jn,[l[9]||(l[9]=o("label",{class:"form-label"},"To:",-1)),o("div",On,[(b(!0),v(N,null,U(p.value,(c,x)=>(b(),v("span",{key:c.id,class:"badge bg-success"},[tt(w(c.first_name)+" ",1),o("button",{type:"button",class:"btn-close btn-close-white btn-sm ms-2",onClick:V=>q(x)},null,8,Vn)]))),128)),o("button",{type:"button",class:"btn btn-sm btn-primary",onClick:l[2]||(l[2]=(...c)=>a.openSmsLeadModal&&a.openSmsLeadModal(...c))},"+")])]),o("div",Hn,[l[11]||(l[11]=o("label",{class:"form-label"},"Template:",-1)),F(o("select",{class:"form-select","onUpdate:modelValue":l[3]||(l[3]=c=>i.value.template=c),onChange:J},[l[10]||(l[10]=o("option",{value:"",disabled:""},"Select a Template",-1)),(b(!0),v(N,null,U(f.value,c=>(b(),v("option",{key:c.id,value:c.id},w(c.name),9,Rn))),128))],544),[[st,i.value.template]])]),o("div",Gn,[l[13]||(l[13]=o("label",{class:"form-label"},"Merge Field:",-1)),o("select",{class:"form-select",onChange:l[4]||(l[4]=c=>W(c))},[l[12]||(l[12]=o("option",{value:""},"Select Tag",-1)),(b(!0),v(N,null,U(u.value,c=>(b(),v("option",{key:c,value:c},w(c),9,Qn))),128))],32)]),l[15]||(l[15]=o("div",{class:"mb-3"},[o("label",{class:"form-label"},"Message:"),o("textarea",{id:"sms-editor"})],-1)),o("div",Wn,[l[14]||(l[14]=o("label",{class:"form-label"},"Schedule SMS:",-1)),F(o("input",{type:"datetime-local",class:"form-control","onUpdate:modelValue":l[5]||(l[5]=c=>i.value.schedule=c)},null,512),[[G,i.value.schedule]])]),o("div",{class:"d-flex justify-content-end gap-2"},[o("button",{class:"btn btn-info",onClick:ne},"Preview"),o("button",{class:"btn btn-success",onClick:se},"Send SMS")])])])],2)])):R("",!0)}},Kn=ie(qn,[["__scopeId","data-v-73b65ca9"]]),Yn={name:"Inbox",components:{SMS:yn,Email:Js,SmsModal:Kn,EmailModal:Nn},data(){return{activeTab:"sms",showSmsModal:!1}},computed:{activeTabComponent(){return this.activeTab==="sms"?"SMS":"Email"}},methods:{openSmsModal(){console.log("[OPEN MODAL] Triggered"),this.showSmsModal=!0},closeSmsModal(){this.showSmsModal=!1}}},Zn={class:"container py-3"},Xn={class:"d-flex justify-content-between align-items-center mb-3"},Jn={class:"btn-group me-3"};function eo(h,m,S,C,d,p){const u=Fs("SmsModal");return b(),v("div",Zn,[o("div",Xn,[o("div",Jn,[o("button",{onClick:m[0]||(m[0]=i=>d.activeTab="email"),class:j(["btn",d.activeTab==="email"?"btn-primary text-white":"btn-outline-primary"])}," Email ",2),o("button",{onClick:m[1]||(m[1]=i=>d.activeTab="sms"),class:j(["btn",d.activeTab==="sms"?"btn-primary text-white":"btn-outline-primary"])}," SMS ",2)]),m[5]||(m[5]=o("div",{class:"me-auto"},[o("select",{class:"form-select",style:{"inline-size":"150px"}},[o("option",null,"Inbox"),o("option",null,"Sent")])],-1)),o("div",null,[m[4]||(m[4]=o("button",{class:"btn btn-primary me-2"},"+ Send New Email",-1)),o("button",{class:"btn btn-success",onClick:m[2]||(m[2]=(...i)=>p.openSmsModal&&p.openSmsModal(...i))},"+ Send New SMS")])]),(b(),Je(Ps(p.activeTabComponent))),d.showSmsModal?(b(),Je(u,{key:0,show:d.showSmsModal,onClose:m[3]||(m[3]=i=>d.showSmsModal=!1)},null,8,["show"])):R("",!0)])}const ho=ie(Yn,[["render",eo]]);export{ho as default};
