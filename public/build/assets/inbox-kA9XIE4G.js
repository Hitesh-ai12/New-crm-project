import{_ as b,o as i,l,j as t,F as p,Y as g,k as c,X as u,L as v,d6 as _,n as m,dd as x,f as w,p as y}from"./main-BaDQntze.js";import{a as f}from"./axios-CdtiCRuU.js";import"./bootstrap.min-KxrJAQL6.js";const k={name:"Email",data(){return{emailList:[{id:1,subject:"Welcome Email",time:"10:00 AM"},{id:2,subject:"Meeting Reminder",time:"12:30 PM"}],emailBody:[{id:1,subject:"Welcome Email",time:"10:00 AM",body:"Welcome to our service!"}]}}},C={class:"row"},M={class:"col-md-4 border-end"},T={class:"list-group"},S=["onClick"],$={class:"col-md-8"},L={key:0,class:"p-3 border rounded"},I={class:"text-muted small"};function z(o,e,a,d,n,r){return i(),l("div",C,[t("div",M,[t("div",T,[(i(!0),l(p,null,g(n.emailList,s=>(i(),l("button",{key:s.id,class:"list-group-item list-group-item-action",onClick:h=>o.selected=s},c(s.subject),9,S))),128))])]),t("div",$,[o.selected?(i(),l("div",L,[t("h5",null,c(o.selected.subject),1),t("div",I,c(o.selected.time),1),t("p",null,c(o.selected.body),1)])):u("",!0)])])}const B=b(k,[["render",z]]),A={data(){return{searchQuery:"",newMessage:"",selectedChat:null,leads:[],messages:[]}},computed:{filteredLeads(){return this.leads.filter(o=>o.name.toLowerCase().includes(this.searchQuery.toLowerCase()))}},methods:{async fetchLeads(){try{const e={Authorization:`Bearer ${localStorage.getItem("auth_token")}`},a=await f.get("/api/sms/leads",{headers:e});this.leads=a.data}catch(o){console.error("Error loading leads:",o)}},async selectChat(o){this.selectedChat=o;try{const a={Authorization:`Bearer ${localStorage.getItem("auth_token")}`},d=await f.get(`/api/sms/lead/${o.leadId}`,{headers:a});this.messages=d.data.reverse(),this.$nextTick(()=>this.scrollToBottom())}catch(e){console.error("Error loading messages:",e)}},scrollToBottom(){const o=this.$refs.messagesArea;o&&(o.scrollTop=o.scrollHeight)},sendMessage(){if(!this.newMessage.trim())return;const o=new Date,e=o.getHours(),a=o.getMinutes(),d=e>=12?"PM":"AM",r=`${e%12===0?12:e%12}:${a<10?"0"+a:a} ${d}`,s={description:this.newMessage,time:r,direction:"sent",date:o.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})};this.messages.push(s),this.newMessage="",this.$nextTick(()=>this.scrollToBottom())}},mounted(){this.fetchLeads()}},E={class:"chat-container d-flex shadow rounded",style:{"block-size":"90vh","margin-block":"20px","margin-inline":"auto","max-inline-size":"1200px"}},j={class:"sidebar border-end d-flex flex-column bg-white",style:{"inline-size":"320px","min-inline-size":"250px"}},D={class:"p-3 border-bottom"},H={class:"flex-grow-1 overflow-auto chat-list"},Q=["onClick"],V={class:"flex-grow-1"},U={class:"fw-bold"},W={class:"chat-window d-flex flex-column flex-grow-1 bg-light"},F={key:0,class:"chat-header d-flex align-items-center p-3 border-bottom bg-white"},K={class:"mb-0 flex-grow-1"},N={key:1,class:"chat-header d-flex align-items-center justify-content-center p-3 text-muted"},P={class:"messages-area flex-grow-1 p-4 overflow-auto",ref:"messagesArea"},Y={key:0,class:"text-center small text-muted mb-2"},R={class:"d-block text-end mt-1 text-white-50"},X={key:2,class:"p-3 border-top bg-white"},q={class:"input-group position-relative"};function G(o,e,a,d,n,r){return i(),l("div",E,[t("div",j,[t("div",D,[v(t("input",{type:"text",class:"form-control rounded-pill",placeholder:"Search lead","onUpdate:modelValue":e[0]||(e[0]=s=>n.searchQuery=s)},null,512),[[_,n.searchQuery]])]),t("div",H,[(i(!0),l(p,null,g(r.filteredLeads,s=>(i(),l("div",{key:s.leadId,onClick:h=>r.selectChat(s),class:m(["d-flex align-items-center p-3 border-bottom chat-item",{"bg-primary text-white":n.selectedChat&&n.selectedChat.leadId===s.leadId}]),style:{cursor:"pointer"}},[e[4]||(e[4]=t("img",{src:"https://cdn-icons-png.flaticon.com/512/1384/1384031.png",width:"45",height:"45",class:"rounded-circle me-3",alt:"Avatar"},null,-1)),t("div",V,[t("div",U,c(s.name),1),t("small",{class:m(["text-muted",{"text-white-50":n.selectedChat&&n.selectedChat.leadId===s.leadId}])}," Lead ID: "+c(s.leadId),3)])],10,Q))),128))])]),t("div",W,[n.selectedChat?(i(),l("div",F,[e[5]||(e[5]=t("img",{src:"https://cdn-icons-png.flaticon.com/512/1384/1384031.png",width:"40",height:"40",class:"rounded-circle me-3",alt:"Avatar"},null,-1)),t("h5",K,c(n.selectedChat.name),1)])):(i(),l("div",N," Select a lead to view messages ")),t("div",P,[n.messages.length&&n.selectedChat?(i(!0),l(p,{key:0},g(n.messages,(s,h)=>(i(),l("div",{key:h,class:"mb-3"},[s.date?(i(),l("div",Y,[t("strong",null,c(s.date),1)])):u("",!0),t("div",{class:m(["message-bubble p-3 rounded shadow-sm",s.direction==="sent"?"bg-success text-white ms-auto":"bg-white me-auto"]),style:{"max-inline-size":"75%"}},[t("div",null,c(s.description),1),t("small",R,c(s.time),1)],2)]))),128)):u("",!0)],512),n.selectedChat?(i(),l("div",X,[t("div",q,[v(t("input",{type:"text",class:"form-control rounded-pill pe-5",placeholder:"Type a message","onUpdate:modelValue":e[1]||(e[1]=s=>n.newMessage=s),onKeyup:e[2]||(e[2]=x((...s)=>r.sendMessage&&r.sendMessage(...s),["enter"]))},null,544),[[_,n.newMessage]]),t("button",{class:"btn btn-primary rounded-circle position-absolute",style:{"block-size":"40px","inline-size":"40px","inset-block-start":"50%","inset-inline-end":"10px",transform:"translateY(-50%)"},onClick:e[3]||(e[3]=(...s)=>r.sendMessage&&r.sendMessage(...s))},e[6]||(e[6]=[t("i",{class:"bi bi-send"},null,-1)]))])])):u("",!0)])])}const J=b(A,[["render",G]]),O={name:"Inbox",components:{SMS:J,Email:B},data(){return{activeTab:"sms"}},computed:{activeTabComponent(){return this.activeTab==="sms"?"SMS":"Email"}},methods:{tabClass(o){return`px-4 py-2 border rounded ${this.activeTab===o?"bg-red-500 text-white":"bg-white text-black"}`}}},Z={class:"container py-3"},ee={class:"btn-group mb-3"};function te(o,e,a,d,n,r){return i(),l("div",Z,[t("div",ee,[t("button",{onClick:e[0]||(e[0]=s=>n.activeTab="sms"),class:m(["btn",n.activeTab==="sms"?"btn-danger":"btn-outline-danger"])}," SMS ",2),t("button",{onClick:e[1]||(e[1]=s=>n.activeTab="email"),class:m(["btn",n.activeTab==="email"?"btn-danger":"btn-outline-danger"])}," Email ",2)]),(i(),w(y(r.activeTabComponent)))])}const ie=b(O,[["render",te]]);export{ie as default};
